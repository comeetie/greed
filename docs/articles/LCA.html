<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LCA • greed</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="LCA">
<meta property="og:description" content="greed">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">greed</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a>
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/graph-clustering-with-sbm.html">Graph clustering</a>
    </li>
    <li>
      <a href="../articles/GMM.html">Gaussian Mixture Model Clustering</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a>
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/comeetie/greed">github</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="LCA_files/header-attrs-2.11/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>LCA</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/comeetie/greed/blob/master/vignettes/LCA.Rmd"><code>vignettes/LCA.Rmd</code></a></small>
      <div class="hidden name"><code>LCA.Rmd</code></div>

    </div>

    
    
<p>Loads the necessary packages for the vignettes.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org">future</a></span><span class="op">)</span> <span class="co"># allows parralel processing in greed()</span>
<span class="fu"><a href="https://future.futureverse.org/reference/plan.html">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://comeetie.github.io/greed/">greed</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rpkgs.datanovia.com/ggpubr/">ggpubr</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jchiquet/aricode">aricode</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/ryentes/careless/">careless</a></span><span class="op">)</span> <span class="co"># string processing</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1234</span><span class="op">)</span></code></pre></div>
<p>The <code>greed</code> package and DLVM framework allows the clustering of categorical data. This vignette describes typical use cases of the <code><a href="../reference/greed.html">greed()</a></code> function in this context, and illustrates its use on real datasets.</p>
<div id="categorical-data-clustering-with-the-latent-class-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#categorical-data-clustering-with-the-latent-class-analysis" class="anchor"></a>Categorical data clustering with the Latent Class Analysis</h1>
<p>We are interested in the clustering of categorical datasets, which are typically found in survey data or item response theory (ITR). In this context, we observe <span class="math inline">\(n\)</span> individuals described by <span class="math inline">\(p\)</span> variables, taking one among <span class="math inline">\(d_j\)</span> modalities for each variable <span class="math inline">\(j\)</span>. Such datasets are typically represented using a one-hot-encoding of each factor in a design matrix <span class="math inline">\(\mathbf{X} \in \{0,1\}^{n \times d}\)</span> where <span class="math inline">\(d = \sum_{j=1}^p d_j\)</span>. Latent class analysis (LCA) is a generative model for categorical data clustering which posits conditional independance of the factor variables conditionally on the (unknown) partition. Below is a description of its Bayesian formulation with the use of proper conjugate priors <span class="math display">\[
\begin{equation}
\begin{aligned}
\pi&amp;\sim \textrm{Dirichlet}(\alpha),\\
\forall k, \forall j, \quad \theta_{kj} &amp;\sim \textrm{Dirichlet}_{d_j}(\beta), \\
Z_i&amp;\sim \mathcal{M}_K(1,\pi),\\
\forall j=1, \ldots, p, \quad X_{ij}|Z_{ik}=1 &amp;\sim \mathcal{M}_{d_j}(1, \theta_{kj}),\\
\end{aligned}
\end{equation}
\]</span> For each cluster <span class="math inline">\(k\)</span> and variable <span class="math inline">\(j\)</span>, the vector <span class="math inline">\(\theta_{kj}\)</span> represents the probability of each of the <span class="math inline">\(d_j\)</span> modalities. With the choice of priors above, the LCA model admits an exact ICL expression similar to the mixture of multinomials <a href="https://static-content.springer.com/esm/art%3A10.1007%2Fs11634-021-00440-z/MediaObjects/11634_2021_440_MOESM1_ESM.pdf">derived here</a> (Section 3) .</p>
</div>
<div id="analysis-of-two-real-datasets" class="section level1">
<h1 class="hasAnchor">
<a href="#analysis-of-two-real-datasets" class="anchor"></a>Analysis of two real datasets</h1>
<p>We now illustrate the use of the <code>greed</code> package on two real datasets:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Mushroom</strong> data from UCI Machine Learning Repository describing 8124 mushrooms with 22 phenotype variables. Each mushroom is classified as “edible” or “poisonous” and the goal is to recover the mushroom class from its phenotype.</li>
<li>
<strong>Young people survey</strong> data from Miroslav Sabo and avalaible on the <a href="https://www.kaggle.com/miroslavsabo/young-people-survey">Kaggle platform</a>. This is an authentic example of questionnaire data where Slovakian young people (15-30 years old) were asked musical preferences according to different genres (rock, hip-hop, classical, etc.).</li>
</ol>
<p>The data are imported by the <code>greed</code> package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"mushroom"</span><span class="op">)</span></code></pre></div>
<div id="mushroom-data" class="section level2">
<h2 class="hasAnchor">
<a href="#mushroom-data" class="anchor"></a>Mushroom data</h2>
<p>We begin by forming the necessary vectors for analysis. The data has <span class="math inline">\(n=8124\)</span> rows and <span class="math inline">\(p=23\)</span> columns. The first column contains the poisonous status of each mushroom with two possible values, “p” for “poisonous” and “e” for edible, it will serve as the clustering we seek to recover. The remaining variables are used for clustering. Note that we only use a subset of the data for illustration purpose here.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">X</span> <span class="op">=</span> <span class="va">mushroom</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>
<span class="va">subset</span> <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span>
<span class="va">label</span> <span class="op">=</span> <span class="va">mushroom</span><span class="op">$</span><span class="va">edibility</span><span class="op">[</span><span class="va">subset</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="va">subset</span>,<span class="op">]</span><span class="op">)</span>
<span class="co">#&gt;      V2 V3 V4 V5 V6 V7 V8 V9 V10 V11 V12 V13 V14 V15 V16 V17 V18 V19 V20 V21</span>
<span class="co">#&gt; 7452  k  s  n  f  f  f  c  n   b   t   ?   k   k   w   w   p   w   o   e   w</span>
<span class="co">#&gt; 8016  k  f  w  f  n  f  w  b   p   e   ?   k   k   w   w   p   w   t   p   w</span>
<span class="co">#&gt; 7162  k  s  n  f  s  f  c  n   b   t   ?   s   s   p   w   p   w   o   e   w</span>
<span class="co">#&gt; 8086  k  f  w  f  n  f  w  b   g   e   ?   s   k   w   w   p   w   t   p   w</span>
<span class="co">#&gt; 7269  x  y  e  f  s  f  c  n   b   t   ?   k   s   p   p   p   w   o   e   w</span>
<span class="co">#&gt; 1004  x  s  w  t  p  f  c  n   w   e   e   s   s   w   w   p   w   o   p   k</span>
<span class="co">#&gt;      V22 V23</span>
<span class="co">#&gt; 7452   v   p</span>
<span class="co">#&gt; 8016   s   g</span>
<span class="co">#&gt; 7162   v   d</span>
<span class="co">#&gt; 8086   s   g</span>
<span class="co">#&gt; 7269   v   d</span>
<span class="co">#&gt; 1004   v   g</span></code></pre></div>
<div id="clustering" class="section level4">
<h4 class="hasAnchor">
<a href="#clustering" class="anchor"></a>Clustering</h4>
<p>The clustering is again done via the main function <code><a href="../reference/greed.html">greed()</a></code> with argument <code>model</code> set to LCA and the genetic hybrid algorithm for ICLex maximization. The value of the <span class="math inline">\(\beta\)</span> hyperparameter for the Dirichlet prior on <span class="math inline">\(\theta_{kj}\)</span> can be specified by the user, it defaults to 1.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sol_greed</span><span class="op">&lt;-</span><span class="fu"><a href="../reference/greed.html">greed</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span><span class="va">subset</span>,<span class="op">]</span> ,model<span class="op">=</span><span class="fu"><a href="../reference/LcaPrior-class.html">Lca</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ------- LCA model fitting ------</span>
<span class="co">#&gt; ################# Generation  1: best solution with an ICL of -12902 and 14 clusters #################</span>
<span class="co">#&gt; ################# Generation  2: best solution with an ICL of -12836 and 16 clusters #################</span>
<span class="co">#&gt; ################# Generation  3: best solution with an ICL of -12822 and 16 clusters #################</span>
<span class="co">#&gt; ################# Generation  4: best solution with an ICL of -12822 and 16 clusters #################</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [70] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [12]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [154] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [13]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [112] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [13]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [42] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [11]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [65] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [11]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [143] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [12]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [104] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [12]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [39] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [10]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [96] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [11]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [55] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [10]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [121] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [12]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [88] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [10]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [33] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [9]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [50] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [9]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [110] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [12]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [80] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [9]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [30] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [8]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [45] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [8]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [99] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [12]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [27] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [7]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [40] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [7]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [88] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [12]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [64] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [9]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [35] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [6]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [77] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [12]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [56] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [9]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [21] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [6]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [66] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [12]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [48] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [9]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [18] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [5]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [25] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [6]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [55] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [12]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [40] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [9]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [15] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; lignes [4]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [20] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [6]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [44] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [12]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [32] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [9]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [15] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [6]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [33] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [12]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [24] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [9]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [9] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [4]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [10] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [6]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [22] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [12]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [16] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [9]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [6] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [4]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [5] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [6]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [11] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [12]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [8] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [9]</span>
<span class="co">#&gt; Warning in matrix(obs_stats$x_counts[[v]], ncol = length(levels(data[[v]]))):</span>
<span class="co">#&gt; la longueur des données [3] n'est pas un diviseur ni un multiple du nombre de</span>
<span class="co">#&gt; colonnes [4]</span>
<span class="co">#&gt; [1] "clean ok"</span>
<span class="co">#&gt; ------- Final clustering -------</span>
<span class="co">#&gt; ICL clustering with a LCA model, 14 clusters and an icl of -12775.</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span>Edibility<span class="op">=</span><span class="va">label</span>, Cluster<span class="op">=</span><span class="fu"><a href="../reference/clustering.html">clustering</a></span><span class="op">(</span><span class="va">sol_greed</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;          Cluster</span>
<span class="co">#&gt; Edibility   1   2   3   4   5   6   7   8   9  10  11  12  13  14</span>
<span class="co">#&gt;         e   0   0   0  14  26  43  24  72   0  15  11  71  31 218</span>
<span class="co">#&gt;         p 201 162   5   7   7   0   0   0  35  24  34   0   0   0</span></code></pre></div>
<p>The hybrid genetic algorithm found a solution with <span class="math inline">\(K=14\)</span> clusters which is quite over-segmented while displaying a good separation among edible and poisonous mushrooms. The ARI of the partition is 0.26 which is explained by the over-segmentation of the solution compared to the <span class="math inline">\(2\)</span>-class problem.</p>
</div>
<div id="hierarchy" class="section level4">
<h4 class="hasAnchor">
<a href="#hierarchy" class="anchor"></a>Hierarchy</h4>
<p>Exploring the dendrogram provided by the hierarchical algorithm is quite useful in this case. We clearly see a hierarchical structure appearing with <span class="math inline">\(K=2\)</span> main clusters. Thus, we can cut the tree at this height and look at the solution.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sol_greed</span>, type<span class="op">=</span><span class="st">'tree'</span><span class="op">)</span></code></pre></div>
<p><img src="LCA_files/figure-html/dendo-mushroom-1.png" width="480"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sol2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">sol_greed</span>, <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span>Edibility<span class="op">=</span><span class="va">label</span>, Cluster<span class="op">=</span><span class="fu"><a href="../reference/clustering.html">clustering</a></span><span class="op">(</span><span class="va">sol2</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;          Cluster</span>
<span class="co">#&gt; Edibility   1   2</span>
<span class="co">#&gt;         e   0 525</span>
<span class="co">#&gt;         p 363 112</span></code></pre></div>
<p>Here, we clearly see that the order of merges is consistent with the labels, and the final ARI is 0.6. While, some poisonous mushrooms have been categorized as edible, this is the consequence of the <a href="https://archive.ics.uci.edu/ml/datasets/Mushroom">way the labels have been set</a>, since mushrooms for which the edibility status was <em>unknown</em> were classified as <em>poisonous</em> by default. While this choice is reasonable from a strict health perspective. Furthermore, as the data documentation specifies, ’‘’’. Thus, the unsupervised problem is hard and the obtained clustering is satisfying on this unsupervised problem. Moreover, this illustrates the interest of having the hierarchical algorithm in order to access coarser partitions.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Etienne Côme, Nicolas Jouvin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
