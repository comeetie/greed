<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>GMM • greed</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="GMM">
<meta property="og:description" content="greed">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">greed</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a>
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/graph-clustering-with-sbm.html">Graph clustering</a>
    </li>
    <li>
      <a href="../articles/GMM.html">Gaussian Mixture Model Clustering</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a>
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/comeetie/greed">github</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="GMM_files/accessible-code-block-0.0.1/empty-anchor.js"></script><link href="GMM_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="GMM_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>GMM</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/comeetie/greed/blob/master/vignettes/GMM.Rmd"><code>vignettes/GMM.Rmd</code></a></small>
      <div class="hidden name"><code>GMM.Rmd</code></div>

    </div>

    
    
<p>Loads packages and set a future plan for parallel processing if you want.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://comeetie.github.io/greed/">greed</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://mclust-org.github.io/mclust/">mclust</a></span><span class="op">)</span>
<span class="co">#&gt; Package 'mclust' version 5.4.7</span>
<span class="co">#&gt; Type 'citation("mclust")' for citing this R package in publications.</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2134</span><span class="op">)</span></code></pre></div>
<div id="full-covariance-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#full-covariance-matrix" class="anchor"></a>Full covariance matrix</h2>
<p>Gaussian Mixture Models (GMMs) are treated in greed in a Bayesian fashion with typical conjugate priors. <span class="math display">\[
\begin{align}
\pi&amp;\sim Dirichlet(\alpha)\\
Z_i&amp;\sim \mathcal{M}(1,\pi)\\
V_k&amp;\sim \mathcal{W}(\varepsilon^{-1},n_0)\\
\mu_k&amp;\sim \mathcal{N}(\mu,(\tau V_k)^{-1})\\
X_{i}|Z_{ik}=1 &amp;\sim \mathcal{N}(\mu_k,V_{k}^{-1})\\
\end{align}
\]</span> Contrary to other models, these priors are informative and may therefore have a sensible impact on the obtained results. By default, the priors parameters are set as follow:</p>
<ul>
<li><span class="math inline">\(\alpha=1\)</span></li>
<li><span class="math inline">\(\mu=\bar{X}\)</span></li>
<li><span class="math inline">\(\tau=0.01\)</span></li>
<li><span class="math inline">\(n_0=d\)</span></li>
<li><span class="math inline">\(\varepsilon=0.1diag(var(X))\)</span></li>
</ul>
<p>See <code><a href="../reference/gmm-class.html">?`gmm-class`</a></code> for more details. These values were chosen to accommodate a variety of situation. Lets look at the results with the diabetes dataset:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">)</span>
<span class="va">X</span><span class="op">=</span><span class="va">diabetes</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>
<span class="va">sol</span> <span class="op">=</span> <span class="fu"><a href="../reference/greed.html">greed</a></span><span class="op">(</span><span class="va">X</span>,model<span class="op">=</span><span class="fu">new</span><span class="op">(</span><span class="st">"gmm"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ------- GMM model fitting ------</span>
<span class="co">#&gt; ################# Generation  1: best solution with an ICL of -2451 and 7 clusters #################</span>
<span class="co">#&gt; ################# Generation  2: best solution with an ICL of -2419 and 4 clusters #################</span>
<span class="co">#&gt; ################# Generation  3: best solution with an ICL of -2406 and 3 clusters #################</span>
<span class="co">#&gt; ################# Generation  4: best solution with an ICL of -2406 and 3 clusters #################</span>
<span class="co">#&gt; ################# Generation  5: best solution with an ICL of -2406 and 3 clusters #################</span>
<span class="co">#&gt; ------- Final clustering -------</span>
<span class="co">#&gt; ICL clustering with a GMM model, 3 clusters and an icl of -2406.</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">$</span><span class="va">cl</span>,<span class="va">sol</span><span class="op">@</span><span class="va">cl</span><span class="op">)</span>
<span class="co">#&gt;           </span>
<span class="co">#&gt;             1  2  3</span>
<span class="co">#&gt;   Chemical 11 24  1</span>
<span class="co">#&gt;   Normal   73  3  0</span>
<span class="co">#&gt;   Overt     0  6 27</span></code></pre></div>
<p>To get an overview of the clustering results, you may use the <code>gmmpairs</code> plot function:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/gmmpairs.html">gmmpairs</a></span><span class="op">(</span><span class="va">sol</span>,<span class="va">X</span><span class="op">)</span>
<span class="co">#&gt; Registered S3 method overwritten by 'GGally':</span>
<span class="co">#&gt;   method from   </span>
<span class="co">#&gt;   +.gg   ggplot2</span></code></pre></div>
<p><img src="GMM_files/figure-html/diabetes-gmm-FIG-1.png" width="90%"></p>
<p>The obtained results are those expected and correspond to the known groups. If you want to experiments with other values for the prior parameters, the most important is <span class="math inline">\(\varepsilon\)</span>, which control the covariance matrix Whishart prior. You may try smaller values for example. In this case, you may also decrease <span class="math inline">\(\tau\)</span> to keep a flat priors on clusters means. For the diabetes data such choices leads to an interesting solution where one cluster is then used to fit one outlier.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">)</span>
<span class="va">X</span><span class="op">=</span><span class="va">diabetes</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>
<span class="va">sol</span> <span class="op">=</span> <span class="fu"><a href="../reference/greed.html">greed</a></span><span class="op">(</span><span class="va">X</span>,model<span class="op">=</span><span class="fu">new</span><span class="op">(</span><span class="st">"gmm"</span>,epsilon<span class="op">=</span><span class="fl">0.01</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diag.html">diag</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html">cov</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, tau <span class="op">=</span><span class="fl">0.001</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ------- GMM model fitting ------</span>
<span class="co">#&gt; ################# Generation  1: best solution with an ICL of -2487 and 10 clusters #################</span>
<span class="co">#&gt; ################# Generation  2: best solution with an ICL of -2473 and 8 clusters #################</span>
<span class="co">#&gt; ################# Generation  3: best solution with an ICL of -2435 and 5 clusters #################</span>
<span class="co">#&gt; ################# Generation  4: best solution with an ICL of -2431 and 4 clusters #################</span>
<span class="co">#&gt; ################# Generation  5: best solution with an ICL of -2431 and 4 clusters #################</span>
<span class="co">#&gt; ------- Final clustering -------</span>
<span class="co">#&gt; ICL clustering with a GMM model, 4 clusters and an icl of -2431.</span>
<span class="fu"><a href="../reference/gmmpairs.html">gmmpairs</a></span><span class="op">(</span><span class="va">sol</span>,<span class="va">X</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">$</span><span class="va">cl</span>,<span class="va">sol</span><span class="op">@</span><span class="va">cl</span><span class="op">)</span>
<span class="co">#&gt;           </span>
<span class="co">#&gt;             1  2  3  4</span>
<span class="co">#&gt;   Chemical 12 23  1  0</span>
<span class="co">#&gt;   Normal   74  2  0  0</span>
<span class="co">#&gt;   Overt     0  3  0 30</span></code></pre></div>
<p><img src="GMM_files/figure-html/diabetes-gmm-0.01-1.png" width="90%"></p>
</div>
<div id="diagonal-covariance-matrix" class="section level2">
<h2 class="hasAnchor">
<a href="#diagonal-covariance-matrix" class="anchor"></a>Diagonal covariance matrix</h2>
<p>You may also used diagonal covariance matrix. The <code><a href="../reference/diaggmm-class.html">?`diaggmm-class`</a></code> allow to use such GMM type model. If you try such model on the previous diabetes dataset, greed this time found a 4 components GMM.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">)</span>
<span class="va">X</span><span class="op">=</span><span class="va">diabetes</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>
<span class="va">soldiag</span> <span class="op">=</span> <span class="fu"><a href="../reference/greed.html">greed</a></span><span class="op">(</span><span class="va">X</span>,model<span class="op">=</span><span class="fu">new</span><span class="op">(</span><span class="st">"diaggmm"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ------- DIAGGMM model fitting ------</span>
<span class="co">#&gt; ################# Generation  1: best solution with an ICL of -2465 and 4 clusters #################</span>
<span class="co">#&gt; ################# Generation  2: best solution with an ICL of -2465 and 4 clusters #################</span>
<span class="co">#&gt; ------- Final clustering -------</span>
<span class="co">#&gt; ICL clustering with a DIAGGMM model, 4 clusters and an icl of -2465.</span>
<span class="fu"><a href="../reference/gmmpairs.html">gmmpairs</a></span><span class="op">(</span><span class="va">soldiag</span>,<span class="va">X</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">$</span><span class="va">cl</span>,<span class="va">soldiag</span><span class="op">@</span><span class="va">cl</span><span class="op">)</span>
<span class="co">#&gt;           </span>
<span class="co">#&gt;             1  2  3  4</span>
<span class="co">#&gt;   Chemical 12 24  0  0</span>
<span class="co">#&gt;   Normal   73  3  0  0</span>
<span class="co">#&gt;   Overt     0  7 13 13</span></code></pre></div>
<p><img src="GMM_files/figure-html/diabetes-diaggmm-1.png" width="90%"></p>
<p>You may still look at coarser clustering and inspect the clustering dendogram:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">soldiag</span>,type<span class="op">=</span><span class="st">'tree'</span><span class="op">)</span>
<span class="va">solK3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">soldiag</span>,<span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">$</span><span class="va">cl</span>,<span class="va">solK3</span><span class="op">@</span><span class="va">cl</span><span class="op">)</span>
<span class="co">#&gt;           </span>
<span class="co">#&gt;             1  2  3</span>
<span class="co">#&gt;   Chemical 12 24  0</span>
<span class="co">#&gt;   Normal   73  3  0</span>
<span class="co">#&gt;   Overt     0  7 26</span></code></pre></div>
<p><img src="GMM_files/figure-html/diabetes-diaggmm-cut-1.png" width="60%"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/gmmpairs.html">gmmpairs</a></span><span class="op">(</span><span class="va">solK3</span>,<span class="va">X</span><span class="op">)</span></code></pre></div>
<p><img src="GMM_files/figure-html/diabetes-diaggmm-cut-pairs-1.png" width="90%"></p>
<p>The clusters corresponds to the known group and if we compare the ICL of the, between the full model:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sol</span><span class="op">@</span><span class="va">icl</span>
<span class="co">#&gt; [1] -2430.727</span>
<span class="va">soldiag</span><span class="op">@</span><span class="va">icl</span>
<span class="co">#&gt; [1] -2465.102</span></code></pre></div>
<p>The full model seems preferable on this dataset. If you want to look at the mixture component parameters you may acces their Maximum a Posteriori estimate with the generic <code>coef</code> function.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">params</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html">coef</a></span><span class="op">(</span><span class="va">solK3</span><span class="op">)</span>
<span class="va">params</span><span class="op">$</span><span class="va">Sigmak</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>
<span class="co">#&gt;          [,1]     [,2]  [,3]</span>
<span class="co">#&gt; [1,] 451.5805     0.00     0</span>
<span class="co">#&gt; [2,]   0.0000 13879.21     0</span>
<span class="co">#&gt; [3,]   0.0000     0.00 25363</span></code></pre></div>
<p>Such simpler diagonal model may be of interest in particular for high dimensional settings for two reasons. First, the number of parameters (even if they are integrated out in the clustering phase) is reduced and this can be interesting when <span class="math inline">\(d\)</span> is important, but also because the prior maybe defined such that it will be less informative. You may try with a subset of the fashion mnist data provided with the package which contains 784 dimensionals vectors (28x28 flattened images). In such settings, you may also want to switch the optimization algorithm to <code><a href="../reference/seed-class.html">?`seed-class`</a></code>, this algorithm is less efficient than the hybrid algorithm used by default by greed. But, since it relied on a seeded initialization it is also a little bit less costly. In this case, you may increase the initial value for <span class="math inline">\(K\)</span> since, this algorithm is not able to find an clustering with a number of cluster bigger than the value of <span class="math inline">\(K\)</span> provided by the user. Still, it may simplify the clustering and return an optimal clustering with less clusters.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"fashion"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html">dim</a></span><span class="op">(</span><span class="va">fashion</span><span class="op">$</span><span class="va">X</span><span class="op">)</span>
<span class="co">#&gt; [1] 1000  784</span>
<span class="va">sol</span><span class="op">=</span><span class="fu"><a href="../reference/greed.html">greed</a></span><span class="op">(</span><span class="va">fashion</span><span class="op">$</span><span class="va">X</span>,model<span class="op">=</span><span class="fu">new</span><span class="op">(</span><span class="st">"diaggmm"</span><span class="op">)</span>,alg<span class="op">=</span><span class="fu">new</span><span class="op">(</span><span class="st">"seed"</span><span class="op">)</span>,K<span class="op">=</span><span class="fl">60</span><span class="op">)</span>
<span class="co">#&gt; ------- DIAGGMM model fitting ------</span>
<span class="co">#&gt; ------- Final clustering -------</span>
<span class="co">#&gt; ICL clustering with a DIAGGMM model, 22 clusters and an icl of -3587798.</span></code></pre></div>
<p>On this more complex dataset, we may look at the dendogram which is more interesting with the complex structure of these data.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sol</span>,type<span class="op">=</span><span class="st">'tree'</span><span class="op">)</span></code></pre></div>
<p><img src="GMM_files/figure-html/fashion-tree-1.png" width="60%"></p>
<p>Finally if we look at the clusters centers, they look coherent and thanks to the hierarchical ordering performed by greed are also well organized.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">im_list</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">sol</span><span class="op">@</span><span class="va">K</span>,<span class="kw">function</span><span class="op">(</span><span class="va">k</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>i<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">28</span><span class="op">:</span><span class="fl">1</span>,each<span class="op">=</span><span class="fl">28</span><span class="op">)</span>,j<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">28</span>,<span class="fl">28</span><span class="op">)</span>,v<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/t.html">t</a></span><span class="op">(</span><span class="va">sol</span><span class="op">@</span><span class="va">obs_stats</span><span class="op">$</span><span class="va">regs</span><span class="op">[[</span><span class="va">k</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">m</span><span class="op">)</span>,k<span class="op">=</span><span class="va">k</span><span class="op">)</span>
    <span class="op">}</span><span class="op">)</span>

<span class="va">ims</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html">do.call</a></span><span class="op">(</span><span class="va">rbind</span>,<span class="va">im_list</span><span class="op">)</span>
<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">ims</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_tile.html">geom_tile</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">i</span>,x<span class="op">=</span><span class="va">j</span>,fill<span class="op">=</span><span class="va">v</span><span class="op">)</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html">scale_fill_gradientn</a></span><span class="op">(</span>colors<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#ffffff"</span>,<span class="st">"#000000"</span><span class="op">)</span>,guide<span class="op">=</span><span class="st">"none"</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_y_continuous</a></span><span class="op">(</span>breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">k</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_fixed.html">coord_equal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span>
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span>axis.title.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span>,axis.title.y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="GMM_files/figure-html/fashion-means-1.png" width="90%"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Etienne Côme, Nicolas Jouvin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
