leafs[l,"xmax"]=max(xch)
coltree=rbind(coltree,leafs[l,])
}
print(coltree$node)
fathers = setdiff(unique(leafs$tree),coltree$node)
fathers=fathers[fathers!=0]
print(fathers)
}
coltree = coltree[order(coltree$node,decreasing = TRUE),]
#coltree = coltree[coltree$K>1,]
rowtree = tree[tree$node %in% clust_rows,]
rowtree$x = seq(-1,1,length.out = length(clust_rows))
leafs   =  rowtree
fathers = unique(leafs$tree)
while(length(fathers)>0){
leafs = tree[tree$node %in% fathers,]
for (l in 1:nrow(leafs)){
no = leafs$node[l]
print(no)
xch = rowtree$x[rowtree$tree==no]
print(xch)
leafs[l,"x"]=mean(xch)
leafs[l,"xmin"]=min(xch)
leafs[l,"xmax"]=max(xch)
rowtree=rbind(rowtree,leafs[l,])
}
fathers = setdiff(unique(leafs$tree),rowtree$node)
fathers=fathers[fathers!=0]
print(fathers)
}
rowtree=rowtree[order(rowtree$node,decreasing = TRUE),]
#rowtree = rowtree[rowtree$K>1,]
sol@ggtreecol = coltree
sol@ggtreerow = rowtree
plot(sol,type='tree')
tree= sol@ggtree[order(sol@ggtree$H),]
coltree = tree[tree$node %in% clust_cols,]
coltree$x = seq(1,-1,length.out = length(clust_cols))
leafs   =  coltree
fathers = unique(leafs$tree)
while(length(fathers)>0){
leafs = tree[tree$node %in% fathers,]
for (l in 1:nrow(leafs)){
no = leafs$node[l]
print(no)
xch = coltree$x[coltree$tree==no]
print(xch)
leafs[l,"x"]=mean(xch)
leafs[l,"xmin"]=min(xch)
leafs[l,"xmax"]=max(xch)
coltree=rbind(coltree,leafs[l,])
}
print(coltree$node)
fathers = setdiff(unique(leafs$tree),coltree$node)
fathers=fathers[fathers!=0]
print(fathers)
}
coltree = coltree[order(coltree$node,decreasing = TRUE),]
#coltree = coltree[coltree$K>1,]
rowtree = tree[tree$node %in% clust_rows,]
rowtree$x = seq(1,-1,length.out = length(clust_rows))
leafs   =  rowtree
fathers = unique(leafs$tree)
while(length(fathers)>0){
leafs = tree[tree$node %in% fathers,]
for (l in 1:nrow(leafs)){
no = leafs$node[l]
print(no)
xch = rowtree$x[rowtree$tree==no]
print(xch)
leafs[l,"x"]=mean(xch)
leafs[l,"xmin"]=min(xch)
leafs[l,"xmax"]=max(xch)
rowtree=rbind(rowtree,leafs[l,])
}
fathers = setdiff(unique(leafs$tree),rowtree$node)
fathers=fathers[fathers!=0]
print(fathers)
}
rowtree=rowtree[order(rowtree$node,decreasing = TRUE),]
#rowtree = rowtree[rowtree$K>1,]
sol@ggtreecol = coltree
sol@ggtreerow = rowtree
plot(sol,type='tree')
tree= sol@ggtree[order(sol@ggtree$H),]
coltree = tree[tree$node %in% clust_cols,]
coltree$x = seq(1,-1,length.out = length(clust_cols))
leafs   =  coltree
fathers = unique(leafs$tree)
leafs
father
fathers
tree[tree$node %in% fathers,]
leafs = tree[tree$node %in% fathers,]
leafs
for (l in 1:nrow(leafs)){
no = leafs$node[l]
print(no)
xch = coltree$x[coltree$tree==no]
print(xch)
leafs[l,"x"]=mean(xch)
leafs[l,"xmin"]=min(xch)
leafs[l,"xmax"]=max(xch)
coltree=rbind(coltree,leafs[l,])
}
coltree
tree= sol@ggtree[order(sol@ggtree$H),]
coltree = tree[tree$node %in% clust_cols,]
coltree$x = seq(1,-1,length.out = length(clust_cols))
leafs   =  coltree
fathers = unique(leafs$tree)
while(length(fathers)>0){
leafs = tree[tree$node %in% fathers,]
coltree = rbind(coltree,leafs)
fathers = setdiff(unique(leafs$tree),coltree$node)
fathers=fathers[fathers!=0]
print(fathers)
}
tree= sol@ggtree[order(sol@ggtree$H),]
coltree = tree[tree$node %in% clust_cols,]
coltree$x = seq(1,-1,length.out = length(clust_cols))
leafs   =  coltree
fathers = unique(leafs$tree)
while(length(fathers)>0){
print(fathers)
leafs = tree[tree$node %in% fathers,]
coltree = rbind(coltree,leafs)
fathers = setdiff(unique(leafs$tree),coltree$node)
fathers=fathers[fathers!=0]
}
coltree
which(coltree$H>0)[1]
tree= sol@ggtree[order(sol@ggtree$H),]
coltree = tree[tree$node %in% clust_cols,]
coltree$x = seq(1,-1,length.out = length(clust_cols))
leafs   =  coltree
fathers = unique(leafs$tree)
while(length(fathers)>0){
print(fathers)
leafs = tree[tree$node %in% fathers,]
coltree = rbind(coltree,leafs)
fathers = setdiff(unique(leafs$tree),coltree$node)
fathers=fathers[fathers!=0]
}
noleaves = (which(coltree$H>0)[1]):nrow(coltree)
for (nl in noleaves){
no =coltree$node[nl]
xch = coltree$x[coltree$tree==no]
print(xch)
coltree[nl,"x"]=mean(xch)
coltree[nl,"xmin"]=min(xch)
coltree[nl,"xmax"]=max(xch)
}
coltree
tree= sol@ggtree[order(sol@ggtree$H),]
coltree = tree[tree$node %in% clust_cols,]
coltree$x = seq(1,-1,length.out = length(clust_cols))
leafs   =  coltree
fathers = unique(leafs$tree)
while(length(fathers)>0){
print(fathers)
leafs = tree[tree$node %in% fathers,]
coltree = rbind(coltree,leafs)
fathers = setdiff(unique(leafs$tree),coltree$node)
fathers=fathers[fathers!=0]
}
coltree=coltree[order(coltree$H),]
noleaves = (which(coltree$H>0)[1]):nrow(coltree)
for (nl in noleaves){
no =coltree$node[nl]
xch = coltree$x[coltree$tree==no]
print(xch)
coltree[nl,"x"]=mean(xch)
coltree[nl,"xmin"]=min(xch)
coltree[nl,"xmax"]=max(xch)
}
coltree
tree= sol@ggtree[order(sol@ggtree$H),]
coltree = tree[tree$node %in% clust_cols,]
coltree$x = seq(1,-1,length.out = length(clust_cols))
leafs   =  coltree
fathers = unique(leafs$tree)
while(length(fathers)>0){
print(fathers)
leafs = tree[tree$node %in% fathers,]
coltree = rbind(coltree,leafs)
fathers = setdiff(unique(leafs$tree),coltree$node)
fathers=fathers[fathers!=0]
}
coltree=coltree[order(coltree$H),]
noleaves = (which(coltree$H>0)[1]):nrow(coltree)
for (nl in noleaves){
no =coltree$node[nl]
xch = coltree$x[coltree$tree==no]
print(xch)
coltree[nl,"x"]=mean(xch)
coltree[nl,"xmin"]=min(xch)
coltree[nl,"xmax"]=max(xch)
}
rowtree = tree[tree$node %in% clust_rows,]
rowtree$x = seq(1,-1,length.out = length(clust_rows))
leafs   =  rowtree
fathers = unique(leafs$tree)
while(length(fathers)>0){
print(fathers)
leafs = tree[tree$node %in% fathers,]
rowtree = rbind(rowtree,leafs)
fathers = setdiff(unique(leafs$tree),rowtree$node)
fathers=fathers[fathers!=0]
}
rowtree=rowtree[order(rowtree$H),]
noleaves = (which(rowtree$H>0)[1]):nrow(rowtree)
for (nl in noleaves){
no =rowtree$node[nl]
xch = rowtree$x[rowtree$tree==no]
print(xch)
coltree[nl,"x"]=mean(xch)
coltree[nl,"xmin"]=min(xch)
coltree[nl,"xmax"]=max(xch)
}
#rowtree = rowtree[rowtree$K>1,]
sol@ggtreecol = coltree
sol@ggtreerow = rowtree
plot(sol,type='tree')
tree= sol@ggtree[order(sol@ggtree$H),]
coltree = tree[tree$node %in% clust_cols,]
coltree$x = seq(1,-1,length.out = length(clust_cols))
leafs   =  coltree
fathers = unique(leafs$tree)
while(length(fathers)>0){
print(fathers)
leafs = tree[tree$node %in% fathers,]
coltree = rbind(coltree,leafs)
fathers = setdiff(unique(leafs$tree),coltree$node)
fathers=fathers[fathers!=0]
}
coltree=coltree[order(coltree$H),]
noleaves = (which(coltree$H>0)[1]):nrow(coltree)
for (nl in noleaves){
no =coltree$node[nl]
xch = coltree$x[coltree$tree==no]
print(xch)
coltree[nl,"x"]=mean(xch)
coltree[nl,"xmin"]=min(xch)
coltree[nl,"xmax"]=max(xch)
}
rowtree = tree[tree$node %in% clust_rows,]
rowtree$x = seq(1,-1,length.out = length(clust_rows))
leafs   =  rowtree
fathers = unique(leafs$tree)
while(length(fathers)>0){
print(fathers)
leafs = tree[tree$node %in% fathers,]
rowtree = rbind(rowtree,leafs)
fathers = setdiff(unique(leafs$tree),rowtree$node)
fathers=fathers[fathers!=0]
}
rowtree=rowtree[order(rowtree$H),]
noleaves = (which(rowtree$H>0)[1]):nrow(rowtree)
for (nl in noleaves){
no =rowtree$node[nl]
xch = rowtree$x[rowtree$tree==no]
print(xch)
rowtree[nl,"x"]=mean(xch)
rowtree[nl,"xmin"]=min(xch)
rowtree[nl,"xmax"]=max(xch)
}
#rowtree = rowtree[rowtree$K>1,]
sol@ggtreecol = coltree
sol@ggtreerow = rowtree
sol
plot(sol,type='tree')
x=sol
ggtree = x@ggtreerow
ggplot2::ggplot()+ggplot2::geom_segment(data=ggtree[ggtree$node %in% ggtree$tree,],ggplot2::aes_(x=~xmin,y=~H,xend=~xmax,yend=~H))
ggtree
ggplot2::ggplot()+ggplot2::geom_segment(data=ggtree[ggtree$node %in% ggtree$tree,],ggplot2::aes_(x=~xmin,y=~H,xend=~xmax,yend=~H))+
ggplot2::geom_segment(data=ggtree[ggtree$Hend!=-1,],ggplot2::aes_(x=~x,y=~H,xend=~x,yend=~Hend))
library(greed)
plot(sol,type='tree')
plot(cut(sol,21),type='tree')
plot(cut(sol,7),type='tree')
sol=greed(FrenchParliament$X)
library(greed)
sol=greed(FrenchParliament$X)
plot(sol)
plot(sol,type='tree')
plot(sol,type='front')
plot(cut(sol,15))
plot(cut(sol,15),type='tree')
plot(cut(sol,7),type='tree')
plot(cut(sol,15),type='tree')
plot(sol,type='front')
plot(sol,type='tree')
library(greed)
plot(sol,type='tree')
plot(cut(sol,15),type='tree')
plot(cut(sol,7),type='tree')
plot(sol)
load("./data-raw/Xvlegislature.rda")
devtools::use_data(Xvlegislature)
devtools::document()
devtools::document()
install.packages("usethis")
install.packages("usethis")
?usethis::use_readme_rmd()
usethis::use_readme_rmd()
?devtools::install_git()
x=sol
ggtree = x@ggtreerow
rowt = ggplot2::ggplot()+ggplot2::geom_segment(data=ggtree[ggtree$node %in% ggtree$tree,],ggplot2::aes_(x=~xmin,y=~H,xend=~xmax,yend=~H))+
ggplot2::geom_segment(data=ggtree[ggtree$Hend!=-1,],ggplot2::aes_(x=~x,y=~H,xend=~x,yend=~Hend))+
ggplot2::scale_x_continuous("",breaks=c())+
ggplot2::ylab(expression(paste("-log(",alpha,")")))+
ggplot2::ggtitle(paste0(x@Krow," row clusters"))+
ggplot2::theme_bw()
if(x@K<max(x@ggtree$K)){
hc = x@ggtree$H[x@ggtree$K==x@K]
rowt=rowt+ggplot2::geom_hline(ggplot2::aes(yintercept=hc),color='red',size=0.8,linetype="dashed",alpha=0.8)
}
ggtree = x@ggtreecol
colt = ggplot2::ggplot()+ggplot2::geom_segment(data=ggtree[ggtree$node %in% ggtree$tree,],ggplot2::aes_(x=~xmin,y=~H,xend=~xmax,yend=~H))+
ggplot2::geom_segment(data=ggtree[ggtree$Hend!=-1,],ggplot2::aes_(x=~x,y=~H,xend=~x,yend=~Hend))+
ggplot2::scale_x_continuous("",breaks=c())+
ggplot2::ylab(expression(paste("-log(",alpha,")")))+
ggplot2::ggtitle(paste0(x@Kcol," column clusters"))+
ggplot2::theme_bw()
if(x@K<max(x@ggtree$K)){
hc = x@ggtree$H[x@ggtree$K==x@K]
colt=colt+ggplot2::geom_hline(aes(yintercept=hc),color='red',size=0.8,linetype="dashed",alpha=0.8)
}
mat=plot(sol)
ggpubr::ggarrange(rowt,mat,ncol = 2,nrow = 1)
ggpubr::ggarrange(rowt+coord_flip(),mat,ncol = 2,nrow = 1)
ggpubr::ggarrange(rowt+ggplot2::coord_flip(),mat,ncol = 2,nrow = 1)
bi_plot = function(x){
ggtree = x@ggtreerow
rowt = ggplot2::ggplot()+ggplot2::geom_segment(data=ggtree[ggtree$node %in% ggtree$tree,],ggplot2::aes_(y=~xmin,x=~H,yend=~xmax,xend=~H))+
ggplot2::geom_segment(data=ggtree[ggtree$Hend!=-1,],ggplot2::aes_(x=~y,x=~H,yend=~x,xend=~Hend))+
ggplot2::scale_x_continuous("",breaks=c())+
ggplot2::ylab(expression(paste("-log(",alpha,")")))+
ggplot2::ggtitle(paste0(x@Krow," row clusters"))+
ggplot2::theme_bw()
if(x@K<max(x@ggtree$K)){
hc = x@ggtree$H[x@ggtree$K==x@K]
rowt=rowt+ggplot2::geom_hline(ggplot2::aes(yintercept=hc),color='red',size=0.8,linetype="dashed",alpha=0.8)
}
ggtree = x@ggtreecol
colt = ggplot2::ggplot()+ggplot2::geom_segment(data=ggtree[ggtree$node %in% ggtree$tree,],ggplot2::aes_(x=~xmin,y=~H,xend=~xmax,yend=~H))+
ggplot2::geom_segment(data=ggtree[ggtree$Hend!=-1,],ggplot2::aes_(x=~x,y=~H,xend=~x,yend=~Hend))+
ggplot2::scale_x_continuous("",breaks=c())+
ggplot2::ylab(expression(paste("-log(",alpha,")")))+
ggplot2::ggtitle(paste0(x@Kcol," column clusters"))+
ggplot2::theme_bw()
if(x@K<max(x@ggtree$K)){
hc = x@ggtree$H[x@ggtree$K==x@K]
colt=colt+ggplot2::geom_hline(aes(yintercept=hc),color='red',size=0.8,linetype="dashed",alpha=0.8)
}
mat = plot(x)
ggpubr::ggarrange(rowt,mat)
}
bi_plot(sol)
bi_plot = function(x){
ggtree = x@ggtreerow
rowt = ggplot2::ggplot()+ggplot2::geom_segment(data=ggtree[ggtree$node %in% ggtree$tree,],ggplot2::aes_(y=~xmin,x=~H,yend=~xmax,xend=~H))+
ggplot2::geom_segment(data=ggtree[ggtree$Hend!=-1,],ggplot2::aes_(x=~y,y=~H,yend=~x,xend=~Hend))+
ggplot2::scale_x_continuous("",breaks=c())+
ggplot2::ylab(expression(paste("-log(",alpha,")")))+
ggplot2::ggtitle(paste0(x@Krow," row clusters"))+
ggplot2::theme_bw()
if(x@K<max(x@ggtree$K)){
hc = x@ggtree$H[x@ggtree$K==x@K]
rowt=rowt+ggplot2::geom_hline(ggplot2::aes(yintercept=hc),color='red',size=0.8,linetype="dashed",alpha=0.8)
}
ggtree = x@ggtreecol
colt = ggplot2::ggplot()+ggplot2::geom_segment(data=ggtree[ggtree$node %in% ggtree$tree,],ggplot2::aes_(x=~xmin,y=~H,xend=~xmax,yend=~H))+
ggplot2::geom_segment(data=ggtree[ggtree$Hend!=-1,],ggplot2::aes_(x=~x,y=~H,xend=~x,yend=~Hend))+
ggplot2::scale_x_continuous("",breaks=c())+
ggplot2::ylab(expression(paste("-log(",alpha,")")))+
ggplot2::ggtitle(paste0(x@Kcol," column clusters"))+
ggplot2::theme_bw()
if(x@K<max(x@ggtree$K)){
hc = x@ggtree$H[x@ggtree$K==x@K]
colt=colt+ggplot2::geom_hline(aes(yintercept=hc),color='red',size=0.8,linetype="dashed",alpha=0.8)
}
mat = plot(x)
ggpubr::ggarrange(rowt,mat)
}
bi_plot(sol)
bi_plot = function(x){
ggtree = x@ggtreerow
rowt = ggplot2::ggplot()+ggplot2::geom_segment(data=ggtree[ggtree$node %in% ggtree$tree,],ggplot2::aes_(y=~xmin,x=~H,yend=~xmax,xend=~H))+
ggplot2::geom_segment(data=ggtree[ggtree$Hend!=-1,],ggplot2::aes_(x=~H,y=~x,yend=~x,xend=~Hend))+
ggplot2::scale_x_continuous("",breaks=c())+
ggplot2::ylab(expression(paste("-log(",alpha,")")))+
ggplot2::ggtitle(paste0(x@Krow," row clusters"))+
ggplot2::theme_bw()
if(x@K<max(x@ggtree$K)){
hc = x@ggtree$H[x@ggtree$K==x@K]
rowt=rowt+ggplot2::geom_hline(ggplot2::aes(yintercept=hc),color='red',size=0.8,linetype="dashed",alpha=0.8)
}
ggtree = x@ggtreecol
colt = ggplot2::ggplot()+ggplot2::geom_segment(data=ggtree[ggtree$node %in% ggtree$tree,],ggplot2::aes_(x=~xmin,y=~H,xend=~xmax,yend=~H))+
ggplot2::geom_segment(data=ggtree[ggtree$Hend!=-1,],ggplot2::aes_(x=~x,y=~H,xend=~x,yend=~Hend))+
ggplot2::scale_x_continuous("",breaks=c())+
ggplot2::ylab(expression(paste("-log(",alpha,")")))+
ggplot2::ggtitle(paste0(x@Kcol," column clusters"))+
ggplot2::theme_bw()
if(x@K<max(x@ggtree$K)){
hc = x@ggtree$H[x@ggtree$K==x@K]
colt=colt+ggplot2::geom_hline(aes(yintercept=hc),color='red',size=0.8,linetype="dashed",alpha=0.8)
}
mat = plot(x)
ggpubr::ggarrange(rowt,mat)
}
bi_plot(sol)
bi_plot = function(x){
ggtree = x@ggtreerow
rowt = ggplot2::ggplot()+ggplot2::geom_segment(data=ggtree[ggtree$node %in% ggtree$tree,],ggplot2::aes_(y=~xmin,x=~-H,yend=~xmax,xend=~-H))+
ggplot2::geom_segment(data=ggtree[ggtree$Hend!=-1,],ggplot2::aes_(x=~-H,y=~x,yend=~x,xend=~-Hend))+
ggplot2::scale_x_continuous("",breaks=c())+
ggplot2::ylab(expression(paste("-log(",alpha,")")))+
ggplot2::ggtitle(paste0(x@Krow," row clusters"))+
ggplot2::theme_bw()
if(x@K<max(x@ggtree$K)){
hc = x@ggtree$H[x@ggtree$K==x@K]
rowt=rowt+ggplot2::geom_hline(ggplot2::aes(yintercept=hc),color='red',size=0.8,linetype="dashed",alpha=0.8)
}
ggtree = x@ggtreecol
colt = ggplot2::ggplot()+ggplot2::geom_segment(data=ggtree[ggtree$node %in% ggtree$tree,],ggplot2::aes_(x=~xmin,y=~H,xend=~xmax,yend=~H))+
ggplot2::geom_segment(data=ggtree[ggtree$Hend!=-1,],ggplot2::aes_(x=~x,y=~H,xend=~x,yend=~Hend))+
ggplot2::scale_x_continuous("",breaks=c())+
ggplot2::ylab(expression(paste("-log(",alpha,")")))+
ggplot2::ggtitle(paste0(x@Kcol," column clusters"))+
ggplot2::theme_bw()
if(x@K<max(x@ggtree$K)){
hc = x@ggtree$H[x@ggtree$K==x@K]
colt=colt+ggplot2::geom_hline(aes(yintercept=hc),color='red',size=0.8,linetype="dashed",alpha=0.8)
}
mat = plot(x)
ggpubr::ggarrange(rowt,mat)
}
bi_plot(sol)
?ggplot2::coord_trans
?ggplot2::coord_filp
?ggplot2::coord_flip
bi_plot = function(x){
ggtree = x@ggtreerow
rowt = ggplot2::ggplot()+ggplot2::geom_segment(data=ggtree[ggtree$node %in% ggtree$tree,],ggplot2::aes_(y=~xmin,x=~H,yend=~xmax,xend=~H))+
ggplot2::geom_segment(data=ggtree[ggtree$Hend!=-1,],ggplot2::aes_(x=~H,y=~x,yend=~x,xend=~Hend))+
ggplot2::scale_x_reverse("",breaks=c())+
ggplot2::ylab(expression(paste("-log(",alpha,")")))+
ggplot2::ggtitle(paste0(x@Krow," row clusters"))+
ggplot2::theme_bw()
if(x@K<max(x@ggtree$K)){
hc = x@ggtree$H[x@ggtree$K==x@K]
rowt=rowt+ggplot2::geom_hline(ggplot2::aes(yintercept=hc),color='red',size=0.8,linetype="dashed",alpha=0.8)
}
ggtree = x@ggtreecol
colt = ggplot2::ggplot()+ggplot2::geom_segment(data=ggtree[ggtree$node %in% ggtree$tree,],ggplot2::aes_(x=~xmin,y=~H,xend=~xmax,yend=~H))+
ggplot2::geom_segment(data=ggtree[ggtree$Hend!=-1,],ggplot2::aes_(x=~x,y=~H,xend=~x,yend=~Hend))+
ggplot2::scale_x_continuous("",breaks=c())+
ggplot2::ylab(expression(paste("-log(",alpha,")")))+
ggplot2::ggtitle(paste0(x@Kcol," column clusters"))+
ggplot2::theme_bw()
if(x@K<max(x@ggtree$K)){
hc = x@ggtree$H[x@ggtree$K==x@K]
colt=colt+ggplot2::geom_hline(aes(yintercept=hc),color='red',size=0.8,linetype="dashed",alpha=0.8)
}
mat = plot(x)
ggpubr::ggarrange(rowt,mat)
}
?ggplot2::coord_flip
bi_plot(sol)
bi_plot(sol)
?scale_x_reverse
ggtree = x@ggtreerow
rowt = ggplot2::ggplot()+ggplot2::geom_segment(data=ggtree[ggtree$node %in% ggtree$tree,],ggplot2::aes_(y=~xmin,x=~H,yend=~xmax,xend=~H))+
ggplot2::geom_segment(data=ggtree[ggtree$Hend!=-1,],ggplot2::aes_(x=~H,y=~x,yend=~x,xend=~Hend))+
ggplot2::scale_x_reverse("",breaks=c())+
ggplot2::ylab(expression(paste("-log(",alpha,")")))+
ggplot2::ggtitle(paste0(x@Krow," row clusters"))+
ggplot2::theme_bw()
if(x@K<max(x@ggtree$K)){
hc = x@ggtree$H[x@ggtree$K==x@K]
rowt=rowt+ggplot2::geom_hline(ggplot2::aes(yintercept=hc),color='red',size=0.8,linetype="dashed",alpha=0.8)
}
rowt
rowt
ggtree = x@ggtreerow
rowt = ggplot2::ggplot()+ggplot2::geom_segment(data=ggtree[ggtree$node %in% ggtree$tree,],ggplot2::aes_(y=~xmin,x=~H,yend=~xmax,xend=~H))+
ggplot2::geom_segment(data=ggtree[ggtree$Hend!=-1,],ggplot2::aes_(x=~H,y=~x,yend=~x,xend=~Hend))+
ggplot2::scale_x_reverse("",breaks=c())+
ggplot2::ylab(expression(paste("-log(",alpha,")")))+
ggplot2::ggtitle(paste0(x@Krow," row clusters"))+
ggplot2::theme_bw()
rowt
ggplot2::ggplot()+ggplot2::geom_segment(data=ggtree[ggtree$node %in% ggtree$tree,],ggplot2::aes_(y=~xmin,x=~H,yend=~xmax,xend=~H))+
ggplot2::geom_segment(data=ggtree[ggtree$Hend!=-1,],ggplot2::aes_(x=~H,y=~x,yend=~x,xend=~Hend))+
ggplot2::scale_x_reverse("",breaks=c())+
ggplot2::ylab(expression(paste("-log(",alpha,")")))+
ggplot2::ggtitle(paste0(x@Krow," row clusters"))+
ggplot2::theme_bw()
ggplot2::ggplot()+ggplot2::geom_segment(data=ggtree[ggtree$node %in% ggtree$tree,],ggplot2::aes_(y=~xmin,x=~H,yend=~xmax,xend=~H))+
ggplot2::geom_segment(data=ggtree[ggtree$Hend!=-1,],ggplot2::aes_(x=~H,y=~x,yend=~x,xend=~Hend))+
ggplot2::scale_x_reverse("",breaks=c())+
ggplot2::ylab(expression(paste("-log(",alpha,")")))+
ggplot2::ggtitle(paste0(x@Krow," row clusters"))+
ggplot2::theme_bw()
ggplot2::ggplot()+ggplot2::geom_segment(data=ggtree[ggtree$node %in% ggtree$tree,],ggplot2::aes_(y=~xmin,x=~H,yend=~xmax,xend=~H))+
ggplot2::geom_segment(data=ggtree[ggtree$Hend!=-1,],ggplot2::aes_(x=~H,y=~x,yend=~x,xend=~Hend))
plot(runif(100))
