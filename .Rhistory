greed:::fit_greed(ms,data,cl,type = "swap")
greed:::fit_greed(ms,data,cl,type = "swap")
greed:::fit_greed(ms,data,cl,type = "swap")
greed:::fit_greed(ms,data,cl,type = "swap")
greed:::fit_greed(ms,data,cl,type = "swap")
greed:::fit_greed(ms,data,cl,type = "swap")
greed:::fit_greed(ms,data,cl,type = "swap")
greed:::fit_greed(ms,data,cl,type = "swap")
greed:::fit_greed(ms,data,cl,type = "swap")
greed:::fit_greed(ms,data,cl,type = "both")
greed:::fit_greed(ms,data,cl,type = "both")
greed:::fit_greed(ms,data,cl,type = "swap")
greed:::fit_greed(ms,data,cl,type = "swap")
greed:::fit_greed(ms,data,cl,type = "swap")
greed:::fit_greed(ms,data,cl,type = "swap")
greed:::fit_greed(ms,data,cl,type = "swap")
greed:::fit_greed(ms,data,cl,type = "swap")
greed:::fit_greed(ms,data,cl,type = "swap")
greed:::fit_greed(ms,data,cl,type = "swap")
greed:::fit_greed(ms,data,cl,type = "swap")
a=greed:::fit_greed(ms,data,cl,type = "swap")
a$cl
a
a@cl
table(a@cl,multsbm$cl)
a=greed:::fit_greed(ms,data,cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
table(a@cl,multsbm$cl)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
table(a@cl,multsbm$cl)
clt = multsbm$cl
clt[1:10]=3
table(a@cl,multsbm$clt)
table(a@cl,clt)
a=greed:::fit_greed(ms,data,clt,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "swap")
a=greed:::fit_greed(ms,data,clt,type = "swap")
table(a@cl,clt)
a=greed:::fit_greed(ms,data,clt,type = "swap")
table(a@cl,clt)
a=greed:::fit_greed(ms,data,clt,type = "swap")
table(a@cl,multsbm$cl)
table(a@cl,clt)
table(a@cl,multsbm$cl)
a=greed:::fit_greed(ms,data,clt,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,clt,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,clt,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,clt,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,clt,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,clt,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,clt,type = "swap",verbose = TRUE)
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "swap",verbose = TRUE)
data$X[clt==1,clt==1,1]
sum(data$X[clt==1,clt==1,1])
sum(data$X[clt==1,clt==2,1])
sum(data$X[clt==2,clt==1,1])
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,clt,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,clt,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,clt,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,clt,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,clt,type = "swap",verbose = TRUE)
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,clt,type = "swap",verbose = TRUE)
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,clt,type = "swap",verbose = TRUE)
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,clt,type = "swap")
a=greed:::fit_greed(ms,data,clt,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap",verbose = TRUE)
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap",verbose = TRUE)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "none")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "none")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "none")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "none")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "none")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "none")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "none")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "merge")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "none")
a@K
a@obs_stats
data$N
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "none")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "none")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
multsbm$x[307,,]
colSums(multsbm$x[307,,])
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
colSums(multsbm$x[398,multsbm$cl==1,])
colSums(multsbm$x[397,multsbm$cl==1,])
colSums(multsbm$x[multsbm$cl==1,397,])
colSums(multsbm$x[397,multsbm$cl==2,])
colSums(multsbm$x[397,multsbm$cl==3,])
multsbm$cl[397]
colSums(multsbm$x[397,multsbm$cl==4,])
colSums(multsbm$x[397,multsbm$cl==5,])
colSums(multsbm$x[397,397,])
multsbm$x[397,397,]
library(greed)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
a=greed:::fit_greed(ms,data,clt,type = "swap")
table(a@cl,multsbm$cl)
a@cl
a=greed:::fit_greed(ms,data,clt,type = "swap")
clt
sum(clt!=multsbm$cl)
a=greed:::fit_greed(ms,data,clt,type = "swap")
a
a@K
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "swap")
cl
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "swap")
a=greed:::fit_greed(ms,data,clt,type = "swap",nb_max_pass = 1)
multsbm$x[multsbm$cl==1,multsbm$cl==1,1]
multsbm$x[multsbm$cl==1,multsbm$cl==1,]
rowSums(multsbm$x[multsbm$cl==1,multsbm$cl==1,])
rowSums(multsbm$x[multsbm$cl==1,multsbm$cl==1,],dims = 2)
rowSums(multsbm$x[multsbm$cl==1,multsbm$cl==1,],dims = 3)
colSums(multsbm$x[multsbm$cl==1,multsbm$cl==1,],dims = 3)
colSums(multsbm$x[multsbm$cl==1,multsbm$cl==1,],dims = 1)
colSums(colSums(multsbm$x[multsbm$cl==1,multsbm$cl==1,],dims = 1))
colSums(colSums(multsbm$x[multsbm$cl==1,multsbm$cl==2,],dims = 1))
multsbm$x[191,,]
multsbm$x[191,multsbm$cl==1,]
colSums(multsbm$x[191,multsbm$cl==1,])
multsbm$x[191,191,]
sum(a)
sum(a@obs_stats$x_counts)
sum(multsbm$x)
multsbm$x[192,multsbm$cl==1,]
multsbm$x[192,192,]
colSums(colSums(multsbm$x[multsbm$cl==1,multsbm$cl==1,],dims = 1))
colSums(colSums(multsbm$x[multsbm$cl==2,multsbm$cl==,],dims = 1))
colSums(colSums(multsbm$x[multsbm$cl==2,multsbm$cl==2,],dims = 1))
a=greed:::fit_greed(ms,data,clt,type = "none")
colSums(colSums(multsbm$x[multsbm$cl==2,multsbm$cl==2,],dims = 1))
a=greed:::fit_greed(ms,data,multsbm$cl,type = "none")
colSums(colSums(multsbm$x[multsbm$cl==2,multsbm$cl==2,],dims = 1))
colSums(colSums(multsbm$x[clt=2,clt==2,],dims = 1))
clt
colSums(colSums(multsbm$x[clt==2,clt==2,],dims = 1))
clt[192]
devtools::document()
library(greed)
greed:::gsum_cube(multsbm$cl,multsbm$x,5)
greed:::gsum_cube(multsbm$cl,multsbm$x,4)
greed:::gsum_cube(multsbm$cl-1,multsbm$x,5)
greed:::gsum_cube(a@cl-1,multsbm$x,5)
a@obs_stats$x_counts
greed:::gsum_cube(a@cl-1,multsbm$x,5)==a@obs_stats$x_counts
all(greed:::gsum_cube(a@cl-1,multsbm$x,5)==a@obs_stats$x_counts)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
all(greed:::gsum_cube(a@cl-1,multsbm$x,5)==a@obs_stats$x_counts)
a=greed:::fit_greed(ms,data,multsbm$cl,type = "swap")
all(greed:::gsum_cube(a@cl-1,multsbm$x,5)==a@obs_stats$x_counts)
a=greed:::fit_greed(ms,data,clt,type = "swap")
which(clt!=multsbm$cl)
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "swap")
a@cl
library(greed)
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "swap")
table(a$cl,multsbm$cl)
table(a@cl,multsbm$cl)
a=greed:::fit_greed(ms,data,clt,type = "swap")
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "swap")
table(a@cl,multsbm$cl)
a=greed:::fit_greed(ms,data,clt,type = "swap")
a=greed:::fit_greed(ms,data,clt,type = "swap")
table(a@cl,multsbm$cl)
a=greed:::fit_greed(ms,data,clt,type = "merge")
table(a@cl,multsbm$cl)
cl[100:125]=6
a=greed:::fit_greed(ms,data,clt,type = "both")
table(a@cl,multsbm$cl)
a=greed:::fit_greed(ms,data,clt,type = "merge")
table(a@cl,multsbm$cl)
a=greed:::fit_greed(ms,data,clt,type = "none")
table(a@cl,multsbm$cl)
a=greed:::fit_greed(ms,data,clt,type = "none")
table(a@cl,multsbm$cl)
clt[100:125]=6
a=greed:::fit_greed(ms,data,clt,type = "none")
clt[100:125]=6
table(a@cl,multsbm$cl)
a=greed:::fit_greed(ms,data,clt,type = "both")
table(a@cl,multsbm$cl)
which(clt==2)[1:25]
which(clt==2)[1:35]
clt[which(clt==2)[1:35]]=6
a=greed:::fit_greed(ms,data,clt,type = "both")
table(a@cl,multsbm$cl)
a=greed:::fit_greed(ms,data,clt,type = "merge")
table(a@cl,multsbm$cl)
a=greed:::fit_greed(ms,data,clt,type = "merge")
table(a@cl,multsbm$cl)
clt[100:125]=multsbm$cl[100:125]
a=greed:::fit_greed(ms,data,clt,type = "merge")
table(a@cl,multsbm$cl)
a=greed:::fit_greed(ms,data,clt,type = "both")
table(a@cl,multsbm$cl)
a=greed:::fit_greed(ms,data,clt,type = "merge")
table(a@cl,multsbm$cl)
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "merge")
a@cl
table(a@cl,multsbm$cl)
sum(a@cl==6)
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "merge")
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "merge")
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "merge")
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "merge")
table(a@cl,multsbm$cl)
library(greed)
a=greed:::fit_greed(ms,data,clt,type = "both")
library(greed)
table(a@cl,multsbm$cl)
greed(multsbm$x)
greed(multsbm$x)
library(greed)
greed(multsbm$x)
sol=greed(multsbm$x)
plot(sol,type='tree')
plot(sol,type='path')
library(greed)
plot(sol,type='path')
plot(sol,type='tree')
plot(sol,type='front')
plot(sol,type='blocks')
table(sol@cl,multsbm$cl)
sol@obs_stats
a=greed:::fit_greed(ms,data,clt,type = "merge")
all(greed:::gsum_cube(a@cl-1,multsbm$x,5)==a@obs_stats$x_counts)
library(greed)
greed(multsbm$x)
sol=greed(multsbm$x)
library(greed)
sol=greed(multsbm$x)
library(greed)
sol=greed(multsbm$x)
library(greed)
sol=greed(multsbm$x)
library(greed)
sol=greed(multsbm$x)
print(sol)
library(greed)
sol=greed(multsbm$x)
library(greed)
sol=greed(multsbm$x)
sol=greed(multsbm$x,alg=new("seed"))
sol=greed(multsbm$x,alg=new("multistarts"))
library(greed)
sol=greed(multsbm$x,alg=new("multistarts"))
sol=greed(multsbm$x,alg=new("genetic"))
sol=greed(multsbm$x,alg=new("seed"))
library(greed)
sol=greed(multsbm$x,alg=new("seed"))
reshape(multsbm$x,c(500,500*3))
reshape(multsbm$x,c(500,500*3),"wide")
reshape(multsbm$x,c(500,500*3),direction="wide")
Reshape(multsbm$x,500,500*3)
?array
sol=greed(multsbm$x,alg=new("seed"))
plot(sol,type="tree*")
plot(sol,type="tree")
plot(sol,type="path")
plot(sol,type="front")
x=sol
M=dim(x@obs_stats$x_counts)[3]
M
ggl = lapply(1:M,function(m){data.frame(kc=rep(cumsum(x@obs_stats$counts),each=K),
lc=rep(cumsum(x@obs_stats$counts),K),
sizek = rep(x@obs_stats$counts,each=K),
sizel = rep(x@obs_stats$counts,K),
count=as.vector(x@obs_stats$x_counts),m=m)})
gg=do.call(rbind,ggl);
gg
graph_blocks_cube = function(x){
K = length(x@obs_stats$counts)
M=dim(x@obs_stats$x_counts)[3]
ggl = lapply(1:M,function(m){data.frame(kc=rep(cumsum(x@obs_stats$counts),each=K),
lc=rep(cumsum(x@obs_stats$counts),K),
sizek = rep(x@obs_stats$counts,each=K),
sizel = rep(x@obs_stats$counts,K),
count=as.vector(x@obs_stats$x_counts),m=paste("Slice ",m),stringsAsFactors = FALSE)})
gg=do.call(rbind,ggl);
ggplot2::ggplot(gg[gg$count>0,])+ggplot2::geom_tile(ggplot2::aes_(x=~kc-sizek/2,y=~lc-sizel/2,width=~sizek,height=~sizel,fill=~count/(sizek*sizel),alpha=~count/(sizek*sizel)))+
ggplot2::facet_wrap(~m)
ggplot2::scale_fill_distiller("Link density",palette="YlOrRd",direction = 1,guide = ggplot2::guide_legend(),limits=c(0,max(gg$count/(gg$sizek*gg$sizel))))+
ggplot2::scale_alpha("Link density",range=c(0,1),limits=c(0,max(gg$count/(gg$sizek*gg$sizel))))+
ggplot2::ggtitle(paste0(toupper(x@model@name)," model with : ",max(x@cl)," clusters."))+
ggplot2::scale_x_continuous("",breaks=cumsum(x@obs_stats$counts),
labels = ifelse(x@obs_stats$counts/sum(x@obs_stats$counts)>0.05,paste0(round(100*x@obs_stats$counts/sum(x@obs_stats$counts)),"%"),""),
minor_breaks = NULL,expand = ggplot2::expansion(mult = 0, add = 0))+
ggplot2::scale_y_continuous("",breaks=cumsum(x@obs_stats$counts),
labels = ifelse(x@obs_stats$counts/sum(x@obs_stats$counts)>0.05,paste0(round(100*x@obs_stats$counts/sum(x@obs_stats$counts)),"%"),""),
minor_breaks = NULL,expand = ggplot2::expansion(mult = 0, add = 0))+
ggplot2::coord_fixed()+ggplot2::theme_bw()
}
graph_blocks_cube(x)
graph_blocks_cube = function(x){
K = length(x@obs_stats$counts)
M=dim(x@obs_stats$x_counts)[3]
ggl = lapply(1:M,function(m){data.frame(kc=rep(cumsum(x@obs_stats$counts),each=K),
lc=rep(cumsum(x@obs_stats$counts),K),
sizek = rep(x@obs_stats$counts,each=K),
sizel = rep(x@obs_stats$counts,K),
count=as.vector(x@obs_stats$x_counts),m=paste("Slice ",m),stringsAsFactors = FALSE)})
gg=do.call(rbind,ggl);
ggplot2::ggplot(gg[gg$count>0,])+ggplot2::geom_tile(ggplot2::aes_(x=~kc-sizek/2,y=~lc-sizel/2,width=~sizek,height=~sizel,fill=~count/(sizek*sizel),alpha=~count/(sizek*sizel)))+
ggplot2::facet_wrap(~m)+
ggplot2::scale_fill_distiller("Link density",palette="YlOrRd",direction = 1,guide = ggplot2::guide_legend(),limits=c(0,max(gg$count/(gg$sizek*gg$sizel))))+
ggplot2::scale_alpha("Link density",range=c(0,1),limits=c(0,max(gg$count/(gg$sizek*gg$sizel))))+
ggplot2::ggtitle(paste0(toupper(x@model@name)," model with : ",max(x@cl)," clusters."))+
ggplot2::scale_x_continuous("",breaks=cumsum(x@obs_stats$counts),
labels = ifelse(x@obs_stats$counts/sum(x@obs_stats$counts)>0.05,paste0(round(100*x@obs_stats$counts/sum(x@obs_stats$counts)),"%"),""),
minor_breaks = NULL,expand = ggplot2::expansion(mult = 0, add = 0))+
ggplot2::scale_y_continuous("",breaks=cumsum(x@obs_stats$counts),
labels = ifelse(x@obs_stats$counts/sum(x@obs_stats$counts)>0.05,paste0(round(100*x@obs_stats$counts/sum(x@obs_stats$counts)),"%"),""),
minor_breaks = NULL,expand = ggplot2::expansion(mult = 0, add = 0))+
ggplot2::coord_fixed()+ggplot2::theme_bw()
}
graph_blocks_cube(x)
M=dim(sol@obs_stats$x_counts)[3]
gglink_list = lapply(1:M,function(m){
ij = which(sol@obs_stats$x_counts[,,m]>0,arr.ind = TRUE)
ld = sol@obs_stats$x_counts[,,m]
#/(sol@obs_stats$counts%*%t(sol@obs_stats$counts))
ij = ij[ij[,1]!=ij[,2],]
gglink = data.frame(from=ij[,1],to=ij[,2],p=ld[ij])
gglink$y=ifelse(gglink$from<gglink$to,-0.3,0.3)
})
gglink_list = lapply(1:M,function(m){
ij = which(sol@obs_stats$x_counts[,,m]>0,arr.ind = TRUE)
ld = sol@obs_stats$x_counts[,,m]
#/(sol@obs_stats$counts%*%t(sol@obs_stats$counts))
ij = ij[ij[,1]!=ij[,2],]
gglink = data.frame(from=ij[,1],to=ij[,2],p=ld[ij])
gglink$y=ifelse(gglink$from<gglink$to,-0.3,0.3)
gglink$m=paste("Slice",m)
})
gglink =do.Call(rbind,gglink_list)
gglink =do.call(rbind,gglink_list)
gglink
gglink_list = lapply(1:M,function(m){
ij = which(sol@obs_stats$x_counts[,,m]>0,arr.ind = TRUE)
ld = sol@obs_stats$x_counts[,,m]
#/(sol@obs_stats$counts%*%t(sol@obs_stats$counts))
ij = ij[ij[,1]!=ij[,2],]
gglink = data.frame(from=ij[,1],to=ij[,2],p=ld[ij])
gglink$y=ifelse(gglink$from<gglink$to,-0.3,0.3)
gglink$m=paste("Slice",m)
gglink
})
gglink =do.call(rbind,gglink_list)
gglink
ggnode_list=lapply(1:M, function(m){data.frame(i=1:length(sol@obs_stats$counts),pi=diag(sol@obs_stats$x_counts[,,m]),m=paste("Slice",m),stringsAsFactors = FALSE)})
ggnode =do.call(rbind,ggnode_list)
gl = ggplot2::guide_legend()
nodelink_cube = function(sol){
M=dim(sol@obs_stats$x_counts)[3]
gglink_list = lapply(1:M,function(m){
ij = which(sol@obs_stats$x_counts[,,m]>0,arr.ind = TRUE)
ld = sol@obs_stats$x_counts[,,m]
#/(sol@obs_stats$counts%*%t(sol@obs_stats$counts))
ij = ij[ij[,1]!=ij[,2],]
gglink = data.frame(from=ij[,1],to=ij[,2],p=ld[ij])
gglink$y=ifelse(gglink$from<gglink$to,-0.3,0.3)
gglink$m=paste("Slice",m)
gglink
})
gglink =do.call(rbind,gglink_list)
ggnode_list=lapply(1:M, function(m){data.frame(i=1:length(sol@obs_stats$counts),pi=diag(sol@obs_stats$x_counts[,,m]),m=paste("Slice",m),stringsAsFactors = FALSE)})
ggnode =do.call(rbind,ggnode_list)
gl = ggplot2::guide_legend()
ggplot2::ggplot()+ggplot2::geom_curve(data=gglink,ggplot2::aes_(x=~from,xend=~to,y=~y,yend=~y,size=~p,alpha=~p),arrow=grid::arrow(length = grid::unit(2,"mm")),curvature = 0.7)+
ggplot2::facet_wrap(~m)+
ggplot2::scale_x_continuous("",c())+
ggplot2::scale_y_continuous("",c(),limits = c(-5,5))+
ggplot2::scale_alpha("Link density:",limits=c(0,max(gglink$p)),guide="none")+
ggplot2::scale_size_area("Clusters size:",limits=c(0,max(ggnode$pi)),max_size = 4,guide="none")+
ggplot2::geom_point(data=ggnode,ggplot2::aes_(x=~i,y=~0,size=~pi))+
ggplot2::ggtitle(paste0(toupper(sol@model@name)," model with : ",max(sol@cl)," clusters."))+
ggplot2::theme_minimal()
}
nodelink_cube(sol)
gglink
library(greed)
cut(sol,3)
plot(cut(sol,3))
plot(cut(sol,5))
?warning
library(greed)
plot(cut(sol,5))
plot(cut(sol,3))
plot(cut(sol,10))
library(greed)
library(greed)
plot(cut(sol,10))
devtools::test()
rm(list = c("graph_blocks_cube", "nodelink_cube"))
library(greed)
rm(list = c("graph_blocks_cube", "nodelink_cube"))
devtools::test()
class(sol)
class(sol@model)
