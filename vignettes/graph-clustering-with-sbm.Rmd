---
title: "Graph clustering with SBM"
author: "Etienne CÃ´me"
date: "`r Sys.Date()`"
fig_caption: yes
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Graph clustering with SBM}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r, fig.show='hold'}
library(greed)
N=1000
D=20
pi=c(0.25,0.25,0.25,0.25)
mu=matrix(0.01,4,D)
mu[1:4,1:4]=diag(rep(1,4))+mu[1:4,1:4]
mu=mu/rowSums(mu)
mm=rmm(N,pi,mu,30)
sol=fit(mm$x,10)
table(sol@cl,mm$cl)


```


```{r, fig.show='hold',out.width="100%",fig.width=9}
plot(sol)
```


```{r, fig.show='hold'}
K=10
pi=rep(1/K,K)
epsilon = 0.0001
lambda  = 0.1
mu=matrix(epsilon,K,K)+diag(rep(lambda,K))
sbm = rsbm(N,pi,mu)
sol=fit(sbm$x,10)
table(sol@cl,sbm$cl)
```

```{r, fig.show='hold',out.width="100%",fig.width=8,fig.height=5.5}
plot(sol)
```