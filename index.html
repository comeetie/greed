<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clustering and Model Selection with the Integrated Classification Likelihood • greed</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Clustering and Model Selection with the Integrated Classification Likelihood">
<meta property="og:description" content="An ensemble of algorithms that enable the clustering of networks and data matrices (such as counts, categorical or continuous) with different type of generative models. Model selection and clustering is performed in combination by optimizing the Integrated Classification Likelihood (which is equivalent to minimizing the description length). Several models are available such as: Stochastic Block Model, degree corrected Stochastic Block Model, Mixtures of Multinomial, Latent Block Model. The optimization is performed thanks to a combination of greedy local search and a genetic algorithm (see &lt;arXiv:2002:11577&gt; for more details).">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">greed</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.6.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a>
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/GMM.html">Gaussian Mixture Models</a>
    </li>
    <li>
      <a href="articles/LCA.html">Latent Class Analysis</a>
    </li>
    <li>
      <a href="articles/MoR.html">Mixture of Regressions</a>
    </li>
    <li>
      <a href="articles/SBM.html">Graph clustering</a>
    </li>
    <li>
      <a href="articles/Mixed-Models.html">Mixed Models</a>
    </li>
    <li>
      <a href="articles/MoM.html">Mixture of Multinomials</a>
    </li>
    <li>
      <a href="articles/LBM.html">Co-clustering and LBM</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a>
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/comeetie/greed" class="external-link">github</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="greed--bayesian-greedy-clustering">GREED : Bayesian greedy clustering<a class="anchor" aria-label="anchor" href="#greed--bayesian-greedy-clustering"></a>
</h1></div>
<!-- badges: start -->

<p>Greed enables model-based clustering of networks, matrices of count data and much more with different types of generative models. Model-selection and clustering are performed in combination by optimizing the Integrated Classification Likelihood. Details of the algorithms and methods proposed by this package can be found in Côme, Jouvin, Latouche, and Bouveyron (2021) <a href="https://doi.org/10.1007/s11634-021-00440-z" class="external-link">10.1007/s11634-021-00440-z</a>.</p>
<p><img src="reference/figures/greed.png" width="200" align="right"></p>
<p>Dedicated to clustering and visualization, the package is very general and currently handles the following tasks:</p>
<ul>
<li>
<strong>Continuous data clustering</strong> with Gaussian Mixture Models. A tutorial is available in <code><a href="articles/GMM.html">vignette("GMM")</a></code>. See also the documentation for the <code>Gmm</code> and <code>DiagGmm</code> S4 classes.</li>
<li>
<strong>Graph data clustering</strong> with the Stochastic Block Model or its degree corrected variants. A tutorial is available in <code><a href="articles/SBM.html">vignette("SBM")</a></code>. See also the documentation for the <code>Sbm</code> and <code>dcSbm</code> S4 classes.</li>
<li>
<strong>Categorical data clustering</strong> with the Latent Class Analysis. A tutorial is available in <code><a href="articles/LCA.html">vignette("LCA")</a></code>. See also the documentation for the <code>Lca</code> S4 class.</li>
<li>
<strong>Count data clustering</strong> with the Mixture of Multinomials model. A tutorial will soon be available in <code><a href="articles/MoM.html">vignette("MoM")</a></code>. For now, we refer to the documentation for the <code>Mom</code> S4 class.</li>
<li>
<strong>Mixed-typed</strong> data clustering, <em>e.g.</em> categorical and numerical but the package handles virtually any type of data combination by stacking models on top of each data types. For example graph data with continuous or categorical data attached to the nodes are handled. A tutorial is available in <code><a href="articles/Mixed-Models.html">vignette("Mixed-Models")</a></code>. See also the documentation for the <code>MixedModels</code> S4 class.</li>
<li>
<strong>Mixture of regression</strong> for simultaneous clustering and fitting a regression model in each cluster. A tutorial is available in <code><a href="articles/MoR.html">vignette("MoR")</a></code>. See also the documentation for the <code>MoR</code> S4 class.</li>
<li>
<strong>Co-clustering</strong> of binary and count-data via the Latent Block Model and its degree-corrected variant. A tutorial will soon be available in <code><a href="articles/LBM.html">vignette("LBM")</a></code>. For now, we refer to the documentation for the <code>DcLbm</code> S4 class.</li>
</ul>
<!-- The following generative models are currently available:  --><!-- * **Stochastic Block Models** (see ``?`Sbm-class` ``), --><!-- * **Degree Corrected Stochastic Block Models** (see ``?`DcSbm-class` ``), --><!-- * **Multinomial Stochastic Block Models** (see ``?`MultSbm-class` ``), --><!-- * **Mixture of Multinomials** (see ``?`MoR-class` ``),  --><!-- * **Latent Class Analysis** (see ``?`Lca-class` ``),  --><!-- * **Gaussian Mixture Model** (see ``?`Gmm-class` `` and ``?`DiagGmm-class` ``), --><!-- * **Multivariate Mixture of Gaussian Regression Model** (see ``?`MoR-class` ``), --><!-- * **Degree Corrected Latent Block Model** (see ``?`DcLbm-class` ``). --><!-- * **Mixed Dlvm's** (see ``?`MixedModels-class` ``). --><p>With the Integrated Classification Likelihood, the parameters of the models are integrated out with a natural regularization effect for complex models. This penalization allows to automatically find a suitable value for the number of clusters <em>K</em><sup>⋆</sup>. A user only needs to provide an initial guess for the number of clusters <em>K</em>, as well as values for the prior parameters (reasonable default values are used if no prior information is given). The default optimization is performed thanks to a combination of a greedy local search and a genetic algorithm described in <a href="https://doi.org/10.1007/s11634-021-00440-z" class="external-link">Côme, Jouvin, Latouche, and Bouveyron (2021)</a>, but several other optimization algorithms are also available.</p>
<p>Eventually, a whole hierarchy of solutions from <em>K</em><sup>⋆</sup> to 1 cluster is extracted. This enables an ordering of the clusters, and the exploration of simpler clustering along the hierarchy. The package also provides some plotting functionality.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of greed from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#GitHub</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"comeetie/greed"</span><span class="op">)</span></code></pre></div>
<p>Or use the CRAN version:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#CRAN</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"greed"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage-the-greed-function">Usage: the greed function<a class="anchor" aria-label="anchor" href="#usage-the-greed-function"></a>
</h2>
<p>The main entry point for using the package is simply the<code>greed</code> function (see <code><a href="reference/greed.html">?greed</a></code>). The generative model will be chosen automatically to fit the type of the provided data, but you may specify another choice with the <code>model</code> argument.</p>
<p>We illustrate its use on a <strong>graph clustering</strong> example with the classical Books network <code><a href="reference/Books.html">?Books</a></code>.</p>
<blockquote>
<p>More use cases and their specific plotting functionality are described below.</p>
</blockquote>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://comeetie.github.io/greed/" class="external-link">greed</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Books</span><span class="op">)</span>
<span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/greed.html">greed</a></span><span class="op">(</span><span class="va">Books</span><span class="op">$</span><span class="va">X</span><span class="op">)</span> 
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Fitting a guess DCSBM model ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ℹ Initializing a population of 20 solutions.</span>
<span class="co">#&gt; ℹ Generation 1 : best solution with an ICL of -1346 and 4 clusters.</span>
<span class="co">#&gt; ℹ Generation 2 : best solution with an ICL of -1346 and 4 clusters.</span>
<span class="co">#&gt; ── Final clustering ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Clustering with a DCSBM model 3 clusters and an ICL of -1345</span></code></pre></div>
<p>You may specify the model you want to use and set the priors parameters with the (<code>model</code> argument), the optimization algorithm (<code>alg</code> argument) and the initial number of cluster <code>K</code>. Here <code>Boos$X</code> is a square sparse matrix and a graph clustering <code><a href="reference/DcSbm.html">?`DcSbm-class`</a></code> model will be used by default. By default, the Hybrid genetic algorithm is used.</p>
<p>The next example illustrates a usage without default values. A binary <code>Sbm</code> prior is used, along with a spectral clustering algorithm for graphs.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/greed.html">greed</a></span><span class="op">(</span><span class="va">Books</span><span class="op">$</span><span class="va">X</span>,model<span class="op">=</span><span class="fu"><a href="reference/Sbm.html">Sbm</a></span><span class="op">(</span><span class="op">)</span>,alg<span class="op">=</span><span class="fu"><a href="reference/Seed-class.html">Seed</a></span><span class="op">(</span><span class="op">)</span>,K<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Fitting a guess SBM model ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Final clustering ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Clustering with a SBM model 5 clusters and an ICL of -1316</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h2>
<p>Many plotting functions are available for exploring the clustering results, and all are accessible via the <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> S4 method. By default, the hierarchical structure found between clusters is returned, as a dendrogram:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/plot-1.png" width="60%"></p>
<p>However, depending of the specified <code>model</code>, a <code>type</code> argument may be specified. Here, with our graph clustering model, a summary representation of the adjacency matrix can be obtained via</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sol</span>,type<span class="op">=</span><span class="st">'blocks'</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/tree-1.png" width="60%"> ## Inspecting the results</p>
<p>The resulting partition may be extracted with the <code><a href="reference/clustering.html">?clustering</a></code> method, as well as the final ICL value with <code><a href="reference/ICL.html">?ICL</a></code>. You may also extract a Maximum a Posteriori (MAP) estimation of the model parameters (conditionally to the estimated clustering) with the <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">?coef</a></code> method.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="reference/clustering.html">clustering</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  1  2  3  4  5 </span>
<span class="co">#&gt; 30 23 11 28 13</span>
<span class="fu"><a href="reference/ICL.html">ICL</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span>
<span class="co">#&gt; [1] -1315.899</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span>
<span class="co">#&gt; $pi</span>
<span class="co">#&gt; [1] 0.2857143 0.2190476 0.1047619 0.2666667 0.1238095</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $thetakl</span>
<span class="co">#&gt;             [,1]       [,2]        [,3]        [,4]       [,5]</span>
<span class="co">#&gt; [1,] 0.310344828 0.06521739 0.009090909 0.000000000 0.00000000</span>
<span class="co">#&gt; [2,] 0.065217391 0.13043478 0.019762846 0.010869565 0.01337793</span>
<span class="co">#&gt; [3,] 0.009090909 0.01976285 0.436363636 0.006493506 0.04895105</span>
<span class="co">#&gt; [4,] 0.000000000 0.01086957 0.006493506 0.084656085 0.27747253</span>
<span class="co">#&gt; [5,] 0.000000000 0.01337793 0.048951049 0.277472527 0.55128205</span></code></pre></div>
<p>Eventually, one may explore some coarser partitions using the <code>cut</code> method:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sol_K3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">sol</span>, <span class="fl">3</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sol_K3</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/cut-1.png" width="60%"></p>
</div>
<div class="section level2">
<h2 id="using-parallel-computing">Using parallel computing<a class="anchor" aria-label="anchor" href="#using-parallel-computing"></a>
</h2>
<p>For large datasets, it is possible to use parallelism to speed-up the computations thanks to the <a href="https://github.com/HenrikBengtsson/future" class="external-link">future</a> package. You only need to specify the type of back-end you want to use, before calling the <code><a href="reference/greed.html">?greed</a></code> function:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span>
<span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span>, workers<span class="op">=</span><span class="fl">2</span><span class="op">)</span> <span class="co"># may be increased</span></code></pre></div>
</div>
</div>
<div class="section level1">
<h1 id="typical-use-cases">Typical use cases<a class="anchor" aria-label="anchor" href="#typical-use-cases"></a>
</h1>
<p>Alongside with the previous graph clustering example below, we give a preview of other use cases and plotting functionalities that are model-dependent.</p>
<div class="section level2">
<h2 id="continuous-data-clustering-with-gmm">Continuous data clustering with GMM<a class="anchor" aria-label="anchor" href="#continuous-data-clustering-with-gmm"></a>
</h2>
<p>Here, we use the diabetes dataset of <code>mclust</code>. <code>X_cont</code> is a 145 × 3 design matrix, and a full-covariance <code>Gmm</code> model is specified as a model prior.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"diabetes"</span>, package <span class="op">=</span> <span class="st">"mclust"</span><span class="op">)</span>
<span class="va">X_cont</span> <span class="op">=</span> <span class="va">diabetes</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>
<span class="va">sol_cont</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/greed.html">greed</a></span><span class="op">(</span>X <span class="op">=</span> <span class="va">X_cont</span>, model<span class="op">=</span><span class="fu"><a href="reference/Gmm.html">Gmm</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Fitting a GMM model ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ℹ Initializing a population of 20 solutions.</span>
<span class="co">#&gt; ℹ Generation 1 : best solution with an ICL of -2413 and 6 clusters.</span>
<span class="co">#&gt; ℹ Generation 2 : best solution with an ICL of -2411 and 6 clusters.</span>
<span class="co">#&gt; ℹ Generation 3 : best solution with an ICL of -2401 and 3 clusters.</span>
<span class="co">#&gt; ℹ Generation 4 : best solution with an ICL of -2401 and 3 clusters.</span>
<span class="co">#&gt; ── Final clustering ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Clustering with a GMM model 3 clusters and an ICL of -2401</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">$</span><span class="va">cl</span>,<span class="fu"><a href="reference/clustering.html">clustering</a></span><span class="op">(</span><span class="va">sol_cont</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;           </span>
<span class="co">#&gt;             1  2  3</span>
<span class="co">#&gt;   Chemical  0 25 11</span>
<span class="co">#&gt;   Normal    0  3 73</span>
<span class="co">#&gt;   Overt    27  6  0</span></code></pre></div>
<p>Specific plots are available for this type of models</p>
<ul>
<li>Pairs plots</li>
</ul>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/gmmpairs.html">gmmpairs</a></span><span class="op">(</span><span class="va">sol_cont</span>, <span class="va">X_cont</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-3-1.png" width="90%"></p>
<ul>
<li>Violins plots</li>
</ul>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sol_cont</span>, type<span class="op">=</span><span class="st">'violins'</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-4-1.png" width="90%"></p>
<blockquote>
<p>See the <code><a href="articles/GMM.html">vignette("GMM")</a></code> for an in-depth tutorial.</p>
</blockquote>
<div class="section level3">
<h3 id="categorical-data-clustering-with-latent-class-analysis">Categorical data clustering with latent class analysis<a class="anchor" aria-label="anchor" href="#categorical-data-clustering-with-latent-class-analysis"></a>
</h3>
<p>Categorical data are typically found in</p>
<ul>
<li>Item response theory<br>
</li>
<li>Questionnaires</li>
</ul>
<p>As an illustrative example, we use an extraction from the <code><a href="reference/Youngpeoplesurvey.html">?Youngpeoplesurvey</a></code> questionaire data, where each variable is an answer to “On a scale of 1 to 5 (NA allowed), how do you like musical genre [X]”, for 19 musical genres [X]. Next table shows a quick glimpse at the data.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"Youngpeoplesurvey"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">X</span><span class="op">[</span>,<span class="fl">2</span><span class="op">:</span><span class="fl">8</span><span class="op">]</span><span class="op">)</span>
<span class="co">#&gt; # A tibble: 6 x 7</span>
<span class="co">#&gt;   `Slow songs or fast songs` Dance Folk  Country `Classical music` Musical Pop  </span>
<span class="co">#&gt;   &lt;fct&gt;                      &lt;fct&gt; &lt;fct&gt; &lt;fct&gt;   &lt;fct&gt;             &lt;fct&gt;   &lt;fct&gt;</span>
<span class="co">#&gt; 1 5                          3     2     1       2                 4       3    </span>
<span class="co">#&gt; 2 3                          2     2     2       4                 3       3    </span>
<span class="co">#&gt; 3 5                          3     2     2       4                 3       5    </span>
<span class="co">#&gt; 4 3                          3     2     1       4                 3       4    </span>
<span class="co">#&gt; 5 5                          3     3     4       4                 4       4    </span>
<span class="co">#&gt; 6 4                          4     3     1       5                 3       5</span></code></pre></div>
<p>Plot the frequency of each modality inside each cluster for all categorical variables. The size of the point represents the frequency, the bigger the point, the larger the frequency.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sol</span><span class="op">=</span><span class="fu"><a href="reference/greed.html">greed</a></span><span class="op">(</span><span class="va">X</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Fitting a LCA model ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ℹ Initializing a population of 20 solutions.</span>
<span class="co">#&gt; ℹ Generation 1 : best solution with an ICL of -5766 and 5 clusters.</span>
<span class="co">#&gt; ℹ Generation 2 : best solution with an ICL of -5740 and 6 clusters.</span>
<span class="co">#&gt; ℹ Generation 3 : best solution with an ICL of -5740 and 6 clusters.</span>
<span class="co">#&gt; ── Final clustering ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Clustering with a LCA model 5 clusters and an ICL of -5730</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sol</span>,type<span class="op">=</span><span class="st">'marginals'</span><span class="op">)</span> </code></pre></div>
<p><img src="reference/figures/survey-lca-cust-1.png" width="100%"></p>
<blockquote>
<p>See the <code><a href="articles/LCA.html">vignette("LCA")</a></code> for details.</p>
</blockquote>
</div>
</div>
<div class="section level2">
<h2 id="graph-clustering-sbm-like-models">Graph clustering, SBM like models<a class="anchor" aria-label="anchor" href="#graph-clustering-sbm-like-models"></a>
</h2>
<p>The SBM allows handling categorical edges for graphs encoding complex, non-binary interaction. This is done through a multinomial SBM implemented in the <code>MultSbm</code> S4 class. A dedicated <code>plot</code> function is available, representing aggregated adjacency matrix for each modality/interaction/<em>view</em>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"NewGuinea"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">NewGuinea</span><span class="op">)</span>
<span class="co">#&gt; [1] 16 16  3</span>
<span class="va">sol_newguinea</span> <span class="op">=</span> <span class="fu"><a href="reference/greed.html">greed</a></span><span class="op">(</span><span class="va">NewGuinea</span>,model<span class="op">=</span><span class="fu"><a href="reference/MultSbm.html">MultSbm</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Fitting a guess MULTSBM model ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ℹ Initializing a population of 20 solutions.</span>
<span class="co">#&gt; ℹ Generation 1 : best solution with an ICL of -125 and 2 clusters.</span>
<span class="co">#&gt; ℹ Generation 2 : best solution with an ICL of -125 and 2 clusters.</span>
<span class="co">#&gt; ── Final clustering ──</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; ── Clustering with a MULTSBM model 2 clusters and an ICL of -125</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sol_newguinea</span>,type<span class="op">=</span><span class="st">'blocks'</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/unnamed-chunk-7-1.png" width="60%"></p>
<blockquote>
<p>See the <code><a href="articles/SBM.html">vignette("SBM")</a></code> for details.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="mixture-of-regression">Mixture of Regression<a class="anchor" aria-label="anchor" href="#mixture-of-regression"></a>
</h2>
<blockquote>
<p>See the <code><a href="articles/MoR.html">vignette("MoR")</a></code> for details.</p>
</blockquote>
</div>
<div class="section level2">
<h2 id="advanced-models">Advanced models`<a class="anchor" aria-label="anchor" href="#advanced-models"></a>
</h2>
<blockquote>
<p>See the <code><a href="articles/Mixed-Models.html">vignette("Mixed-Models")</a></code>for details.</p>
</blockquote>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=greed" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/comeetie/greed/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/comeetie/greed/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing greed</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Etienne Côme <br><small class="roles"> Author, maintainer </small>  </li>
<li>Nicolas Jouvin <br><small class="roles"> Author </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/comeetie/greed/actions" class="external-link"><img src="https://github.com/comeetie/greed/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://CRAN.R-project.org/package=greed" class="external-link"><img src="https://www.r-pkg.org/badges/version/greed" alt="CRAN status"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Etienne Côme, Nicolas Jouvin.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
