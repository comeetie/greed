<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clustering and Model Selection with the Integrated Classification Likelihood • greed</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Clustering and Model Selection with the Integrated Classification Likelihood">
<meta property="og:description" content="An ensemble of algorithms that enable the clustering of networks and data matrix such as counts matrix with different type of generative models. Model selection and clustering is performed in combination by optimizing the Integrated Classification Likelihood (which is equivalent to minimizing the description length). Several models are available such as: Stochastic Block Model, degree corrected Stochastic Block Model, Mixtures of Multinomial, Latent Block Model. The optimization is performed thanks to a combination of greedy local search and a genetic algorithm (see &lt;arXiv:2002:11577&gt; for more details).">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">greed</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a>
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/GMM.html">Gaussian Mixture Models</a>
    </li>
    <li>
      <a href="articles/LCA.html">Latent Class Analysis</a>
    </li>
    <li>
      <a href="articles/MoR.html">Mixture of Regressions</a>
    </li>
    <li>
      <a href="articles/SBM.html">Graph clustering</a>
    </li>
    <li>
      <a href="articles/Mixed-Models.html">Mixed Models</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a>
    <span class="fa fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/comeetie/greed" class="external-link">github</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div class="section level1">
<div class="page-header"><h1 id="greed--bayesian-greedy-clustering">GREED : Bayesian greedy clustering<a class="anchor" aria-label="anchor" href="#greed--bayesian-greedy-clustering"></a>
</h1></div>
<!-- badges: start -->

<p>Greed enables model based clustering of networks, matrices of count data and much more with different types of generative models. Model selection and clustering is performed in combination by optimizing the Integrated Classification Likelihood. Details of the algorithms and methods proposed by this package can be found in Côme, Jouvin, Latouche, and Bouveyron (2021) <a href="https://doi.org/10.1007/s11634-021-00440-z" class="external-link">10.1007/s11634-021-00440-z</a>.</p>
<p><img src="reference/figures/greed.png" width="200" align="right"></p>
<p>The following generative models are available currently :</p>
<ul>
<li>
<strong>Stochastic Block Models</strong> (see <code><a href="reference/Sbm.html">?`Sbm-class`</a></code>),</li>
<li>
<strong>Degree Corrected Stochastic Block Models</strong> (see <code><a href="reference/DcSbm.html">?`DcSbm-class`</a></code>),</li>
<li>
<strong>Multinomial Stochastic Block Models</strong> (see <code><a href="reference/MultSbm.html">?`MultSbm-class`</a></code>),</li>
<li>
<strong>Mixture of Multinomials</strong> (see <code><a href="reference/MoR.html">?`MoR-class`</a></code>),</li>
<li>
<strong>Latent Class Analysis</strong> (see <code><a href="reference/Lca.html">?`Lca-class`</a></code>),</li>
<li>
<strong>Gaussian Mixture Model</strong> (see <code><a href="reference/Gmm.html">?`Gmm-class`</a></code> and <code><a href="reference/DiagGmm.html">?`DiagGmm-class`</a></code>),</li>
<li>
<strong>Multivariate Mixture of Gaussian Regression Model</strong> (see <code><a href="reference/MoR.html">?`MoR-class`</a></code>),</li>
<li>
<strong>Degree Corrected Latent Block Model</strong> (see <code><a href="reference/DcLbm.html">?`DcLbm-class`</a></code>).</li>
<li>
<strong>Mixed Dlvm’s</strong> (see <code><a href="reference/MixedModels.html">?`MixedModels-class`</a></code>).</li>
</ul>
<p>With the Integrated Classification Likelihood, the parameters of the models are integrated out. This allows a natural regularization for complex models. Since the Integrated Classification Likelihood penalizes complex models it allows to automatically find a “natural” value for the number of clusters <em>K</em><sup>*</sup>, the user only needs to provide an initial guess as well as values for the prior parameters (sensible default values are used if no prior information is available). The optimization is performed by default thanks to a combination of a greedy local search and a genetic algorithm. Several optimization algorithms are available.</p>
<p>Eventually, the whole path of solutions from <em>K</em><sup>*</sup> to 1 cluster is extracted. This enables a partial ordering of the clusters, and the evaluation of simpler clustering. The package also provides some plotting functionality.</p>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<p>You can install the development version of greed from <a href="https://github.com/" class="external-link">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#GitHub</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"comeetie/greed"</span><span class="op">)</span></code></pre></div>
<p>Or use the CRAN version:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#CRAN</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"greed"</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="usage">Usage<a class="anchor" aria-label="anchor" href="#usage"></a>
</h2>
<p>The main entry point for using the package is simply the greed function (<code><a href="reference/greed.html">?greed</a></code>). The generative model will be chosen automatically to fit with the data provided, but you may specify another choice with the model parameter. This is a basic example with the classical Books network <code><a href="reference/Books.html">?Books</a></code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://comeetie.github.io/greed/" class="external-link">greed</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Books</span><span class="op">)</span>
<span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/greed.html">greed</a></span><span class="op">(</span><span class="va">Books</span><span class="op">$</span><span class="va">X</span><span class="op">)</span>
<span class="co">#&gt; ------- guess DCSBM model fitting ------</span>
<span class="co">#&gt; ################# Generation  1: best solution with an ICL of -1346 and 4 clusters #################</span>
<span class="co">#&gt; ################# Generation  2: best solution with an ICL of -1346 and 4 clusters #################</span>
<span class="co">#&gt; ------- Final clustering -------</span>
<span class="co">#&gt; ICL clustering with a DCSBM model, 3 clusters and an icl of -1345.</span></code></pre></div>
<p>You may specify the model you want to use and set the priors parameters with the (model argument), the optimization algorithm (alg argument) and the initial number of cluster K. Here football is a square sparse matrix and a graph clustering <code><a href="reference/DcSbm.html">?`DcSbm-class`</a></code> model will be used by default, and the Hybrid genetic algorithm greed used.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/greed.html">greed</a></span><span class="op">(</span><span class="va">Books</span><span class="op">$</span><span class="va">X</span>,model<span class="op">=</span><span class="fu"><a href="reference/Sbm.html">Sbm</a></span><span class="op">(</span><span class="op">)</span>,alg<span class="op">=</span><span class="fu"><a href="reference/Seed-class.html">Seed</a></span><span class="op">(</span><span class="op">)</span>,K<span class="op">=</span><span class="fl">10</span><span class="op">)</span>
<span class="co">#&gt; ------- guess SBM model fitting ------</span>
<span class="co">#&gt; ------- Final clustering -------</span>
<span class="co">#&gt; ICL clustering with a SBM model, 5 clusters and an icl of -1257.</span></code></pre></div>
<p>Some plotting function enable the exploration of the clustering results, the hierarchical structure between clusters:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/plot-1.png" width="60%"></p>
<p>Or a summary représentation of the adjacency matrix:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">sol</span>,type<span class="op">=</span><span class="st">'blocks'</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/tree-1.png" width="60%"></p>
<p>You may extract the model fitted parameters with the <code><a href="https://rdrr.io/r/stats/coef.html" class="external-link">?coef</a></code> function, the clustering with the <code><a href="reference/clustering.html">?clustering</a></code> function, the value of ICL with <code><a href="reference/ICL.html">?ICL</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/ICL.html">ICL</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span>
<span class="co">#&gt; [1] -1256.988</span>
<span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span>
<span class="co">#&gt; $pi</span>
<span class="co">#&gt; [1] 0.09523810 0.29523810 0.19047619 0.36190476 0.05714286</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $thetakl</span>
<span class="co">#&gt;             [,1]        [,2]        [,3]        [,4]       [,5]</span>
<span class="co">#&gt; [1,] 0.711111111 0.329032258 0.060000000 0.002631579 0.00000000</span>
<span class="co">#&gt; [2,] 0.329032258 0.090322581 0.008064516 0.001697793 0.00000000</span>
<span class="co">#&gt; [3,] 0.060000000 0.008064516 0.231578947 0.019736842 0.04166667</span>
<span class="co">#&gt; [4,] 0.002631579 0.001697793 0.019736842 0.099573257 0.43859649</span>
<span class="co">#&gt; [5,] 0.000000000 0.000000000 0.041666667 0.438596491 0.73333333</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="reference/clustering.html">clustering</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  1  2  3  4  5 </span>
<span class="co">#&gt; 10 31 20 38  6</span></code></pre></div>
<p>Eventually, one may explore some coarser clustering using the cut function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html" class="external-link">cut</a></span><span class="op">(</span><span class="va">sol</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/cut-1.png" width="60%"></p>
<p>For large datasets, it is possible to use parallelism to speed-up the computation thanks to the <a href="https://github.com/HenrikBengtsson/future" class="external-link">future</a> package. You only need to specify the type of backend you want to use, before calling the <code><a href="reference/greed.html">?greed</a></code> function:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://future.futureverse.org" class="external-link">future</a></span><span class="op">)</span>
<span class="fu"><a href="https://future.futureverse.org/reference/plan.html" class="external-link">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="typical-use-cases">Typical use cases<a class="anchor" aria-label="anchor" href="#typical-use-cases"></a>
</h2>
<div class="section level3">
<h3 id="classical-clustering-gmm">Classical clustering, GMM<a class="anchor" aria-label="anchor" href="#classical-clustering-gmm"></a>
</h3>
<p>See the <code><a href="articles/GMM.html">vignette("GMM")</a></code> for details.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"diabetes"</span>,package <span class="op">=</span> <span class="st">"mclust"</span><span class="op">)</span>
<span class="va">X</span> <span class="op">&lt;-</span> <span class="va">diabetes</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span>
<span class="va">sol</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/greed.html">greed</a></span><span class="op">(</span><span class="va">X</span>,model<span class="op">=</span><span class="fu"><a href="reference/Gmm.html">Gmm</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; ------- GMM model fitting ------</span>
<span class="co">#&gt; ################# Generation  1: best solution with an ICL of -2421 and 6 clusters #################</span>
<span class="co">#&gt; ################# Generation  2: best solution with an ICL of -2416 and 5 clusters #################</span>
<span class="co">#&gt; ################# Generation  3: best solution with an ICL of -2406 and 3 clusters #################</span>
<span class="co">#&gt; ################# Generation  4: best solution with an ICL of -2396 and 3 clusters #################</span>
<span class="co">#&gt; ################# Generation  5: best solution with an ICL of -2396 and 3 clusters #################</span>
<span class="co">#&gt; ################# Generation  6: best solution with an ICL of -2396 and 3 clusters #################</span>
<span class="co">#&gt; ------- Final clustering -------</span>
<span class="co">#&gt; ICL clustering with a GMM model, 3 clusters and an icl of -2396.</span>
<span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">diabetes</span><span class="op">$</span><span class="va">cl</span>,<span class="fu"><a href="reference/clustering.html">clustering</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;           </span>
<span class="co">#&gt;             1  2  3</span>
<span class="co">#&gt;   Chemical 11 24  1</span>
<span class="co">#&gt;   Normal   73  3  0</span>
<span class="co">#&gt;   Overt     0  6 27</span>
<span class="fu"><a href="reference/gmmpairs.html">gmmpairs</a></span><span class="op">(</span><span class="va">sol</span>,<span class="va">X</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/diabetes-gmm-1.png" width="90%"></p>
</div>
<div class="section level3">
<h3 id="questionnary-and-item-response-theory-datasets-lca">Questionnary and item response theory datasets, LCA<a class="anchor" aria-label="anchor" href="#questionnary-and-item-response-theory-datasets-lca"></a>
</h3>
<p>See the <code><a href="articles/LCA.html">vignette("LCA")</a></code> for details.</p>
</div>
<div class="section level3">
<h3 id="graphs-sbm-like-models">Graphs, SBM like models<a class="anchor" aria-label="anchor" href="#graphs-sbm-like-models"></a>
</h3>
<p>See the <code><a href="articles/SBM.html">vignette("SBM")</a></code> for details.</p>
</div>
<div class="section level3">
<h3 id="mixture-of-regression">Mixture of Regression<a class="anchor" aria-label="anchor" href="#mixture-of-regression"></a>
</h3>
<p>See the<code><a href="articles/MoR.html">vignette("MoR")</a></code> for details.</p>
</div>
<div class="section level3">
<h3 id="advanced-models">Advanced models<a class="anchor" aria-label="anchor" href="#advanced-models"></a>
</h3>
<p>See the <code>vignette("Mixed Models")</code>for details.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://cloud.r-project.org/package=greed" class="external-link">View on CRAN</a></li>
<li><a href="https://github.com/comeetie/greed/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/comeetie/greed/issues" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li>GPL</li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing greed</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Etienne Côme <br><small class="roles"> Author, maintainer </small>  </li>
<li>Nicolas Jouvin <br><small class="roles"> Author </small>  </li>
</ul>
</div>

<div class="dev-status">
<h2 data-toc-skip>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/comeetie/greed/actions" class="external-link"><img src="https://github.com/comeetie/greed/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://CRAN.R-project.org/package=greed" class="external-link"><img src="https://www.r-pkg.org/badges/version/greed" alt="CRAN status"></a></li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Etienne Côme, Nicolas Jouvin.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
