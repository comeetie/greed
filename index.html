<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clustering and Model Selection with the Integrated Classification Likelihood • greed</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Clustering and Model Selection with the Integrated Classification Likelihood">
<meta property="og:description" content="An ensemble of algorithms that enable the clustering of networks and data matrix such as counts matrix with different type of generative models. Model selection and clustering is performed in combination by optimizing the Integrated Classification Likelihood (which is equivalent to minimizing the description length). Several models are available such as: Stochastic Block Model, degree corrected Stochastic Block Model, Mixtures of Multinomial, Latent Block Model. The optimization is performed thanks to a combination of greedy local search and a genetic algorithm (see &lt;arXiv:2002:11577&gt; for more details).">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">greed</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a>
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/graph-clustering-with-sbm.html">Graph clustering</a>
    </li>
    <li>
      <a href="articles/GMM.html">Gaussian Mixture Model Clustering</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a>
    <span class="fas fa-github"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/comeetie/greed">github</a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="greed--bayesian-greedy-clustering" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#greed--bayesian-greedy-clustering" class="anchor"></a>GREED : Bayesian greedy clustering</h1></div>
<!-- badges: start -->

<p>Greed enables model based clustering of networks, matrices of count data and much more with different types of generative models. Model selection and clustering is performed in combination by optimizing the Integrated Classification Likelihood. Details of the algorithms and methods proposed by this package can be found in Côme, Jouvin, Latouche, and Bouveyron (2021) <a href="https://doi.org/10.1007/s11634-021-00440-z">10.1007/s11634-021-00440-z</a>.</p>
<p><img src="reference/figures/greed.png" width="200" align="right"></p>
<p>The following generative models are available currently :</p>
<ul>
<li>
<strong>Stochastic Block Models</strong> (see <code><a href="reference/sbm-class.html">?`sbm-class`</a></code> and <code><a href="reference/misssbm-class.html">?`misssbm-class`</a></code>),</li>
<li>
<strong>Degree Corrected Stochastic Block Models</strong> (see <code><a href="reference/dcsbm-class.html">?`dcsbm-class`</a></code>),</li>
<li>
<strong>Multinomial Stochastic Block Models</strong> (see <code><a href="reference/multsbm-class.html">?`multsbm-class`</a></code>),</li>
<li>
<strong>Degree Corrected Latent Block Models</strong> (see <code><a href="reference/co_dcsbm-class.html">?`co_dcsbm-class`</a></code>),</li>
<li>
<strong>Mixture of Multinomials</strong> (see <code><a href="reference/mm-class.html">?`mm-class`</a></code>),</li>
<li>
<strong>Gaussian Mixture Model</strong> (see <code><a href="reference/gmm-class.html">?`gmm-class`</a></code> and <code><a href="reference/diaggmm-class.html">?`diaggmm-class`</a></code>),</li>
<li>
<strong>Multivariate Mixture of Gaussian Regression Model</strong> (see <code><a href="reference/mvmreg-class.html">?`mvmreg-class`</a></code>).</li>
</ul>
<p>With the Integrated Classification Likelihood, the parameters of the models are integrated out. This allows a natural regularization for complex models. Since the Integrated Classification Likelihood penalizes complex models it allows to automatically find a “natural” value for the number of clusters <span class="math inline"><em>K</em><sup>*</sup></span>, the user only needs to provide an initial guess as well as values for the prior parameters (sensible default values are used if no prior information is available). The optimization is performed by default thanks to a combination of a greedy local search and a genetic algorithm. Several optimization algorithms are available.</p>
<p>Eventually, the whole path of solutions from <span class="math inline"><em>K</em><sup>*</sup></span> to 1 cluster is extracted. This enables a partial ordering of the clusters, and the evaluation of simpler clustering. The package also provides some plotting functionality.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the development version of greed from <a href="https://github.com/">GitHub</a> with:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#GitHub</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"comeetie/greed"</span><span class="op">)</span></code></pre></div>
<p>Or use the CRAN version:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#CRAN</span>
<span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"greed"</span><span class="op">)</span></code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>The main entry point for using the package is simply the greed function (<code><a href="reference/greed.html">?greed</a></code>). The generative model will be chosen automatically to fit with the data provided, but you may specify another choice with the model parameter. This is a basic example with the classical Jazz network:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://comeetie.github.io/greed/">greed</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Jazz</span><span class="op">)</span>
<span class="va">sol</span><span class="op">=</span><span class="fu"><a href="reference/greed.html">greed</a></span><span class="op">(</span><span class="va">Jazz</span><span class="op">)</span>
<span class="co">#&gt; ------- undirected DCSBM model fitting ------</span>
<span class="co">#&gt; ################# Generation  1: best solution with an ICL of -28628 and 18 clusters #################</span>
<span class="co">#&gt; ################# Generation  2: best solution with an ICL of -28617 and 17 clusters #################</span>
<span class="co">#&gt; ################# Generation  3: best solution with an ICL of -28601 and 15 clusters #################</span>
<span class="co">#&gt; ################# Generation  4: best solution with an ICL of -28584 and 16 clusters #################</span>
<span class="co">#&gt; ################# Generation  5: best solution with an ICL of -28582 and 13 clusters #################</span>
<span class="co">#&gt; ################# Generation  6: best solution with an ICL of -28579 and 17 clusters #################</span>
<span class="co">#&gt; ################# Generation  7: best solution with an ICL of -28577 and 17 clusters #################</span>
<span class="co">#&gt; ################# Generation  8: best solution with an ICL of -28577 and 17 clusters #################</span>
<span class="co">#&gt; ################# Generation  9: best solution with an ICL of -28577 and 17 clusters #################</span>
<span class="co">#&gt; ------- Final clustering -------</span>
<span class="co">#&gt; ICL clustering with a DCSBM model, 16 clusters and an icl of -28561.</span></code></pre></div>
<p>Here Jazz is a square sparse matrix and a <code><a href="reference/dcsbm-class.html">?`dcsbm-class`</a></code> model will be used by default. Some plotting function enable the exploration of the clustering results:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/plot-1.png" width="60%"></p>
<p>And the hierarchical structure between clusters:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sol</span>,type<span class="op">=</span><span class="st">'tree'</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/tree-1.png" width="60%"></p>
<p>Eventually, one may explore some coarser clustering using the cut function:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cut.html">cut</a></span><span class="op">(</span><span class="va">sol</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/cut-1.png" width="60%"></p>
<p>For large datasets, it is possible to use parallelism to speed-up the computation thanks to the <a href="https://github.com/HenrikBengtsson/future">future</a> package. You only need to specify the type of backend you want to use.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/HenrikBengtsson/future">future</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/future/man/plan.html">plan</a></span><span class="op">(</span><span class="va">multisession</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="st">"Blogs"</span><span class="op">)</span>
<span class="va">sol</span><span class="op">=</span><span class="fu"><a href="reference/greed.html">greed</a></span><span class="op">(</span><span class="va">Blogs</span><span class="op">$</span><span class="va">X</span><span class="op">)</span>
<span class="co">#&gt; ------- directed DCSBM model fitting ------</span>
<span class="co">#&gt; ################# Generation  1: best solution with an ICL of -84494 and 19 clusters #################</span>
<span class="co">#&gt; ################# Generation  2: best solution with an ICL of -84348 and 18 clusters #################</span>
<span class="co">#&gt; ################# Generation  3: best solution with an ICL of -84227 and 18 clusters #################</span>
<span class="co">#&gt; ################# Generation  4: best solution with an ICL of -84220 and 18 clusters #################</span>
<span class="co">#&gt; ################# Generation  5: best solution with an ICL of -84165 and 16 clusters #################</span>
<span class="co">#&gt; ################# Generation  6: best solution with an ICL of -84141 and 18 clusters #################</span>
<span class="co">#&gt; ################# Generation  7: best solution with an ICL of -84130 and 18 clusters #################</span>
<span class="co">#&gt; ################# Generation  8: best solution with an ICL of -84125 and 17 clusters #################</span>
<span class="co">#&gt; ################# Generation  9: best solution with an ICL of -84125 and 17 clusters #################</span>
<span class="co">#&gt; ------- Final clustering -------</span>
<span class="co">#&gt; ICL clustering with a DCSBM model, 16 clusters and an icl of -84099.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/future-1.png" width="60%"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=greed">https://​cloud.r-project.org/​package=greed</a>
</li>
<li>Browse source code at <br><a href="https://github.com/comeetie/greed/">https://​github.com/​comeetie/​greed/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/comeetie/greed/issues">https://​github.com/​comeetie/​greed/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Etienne Côme <br><small class="roles"> Author, maintainer </small>  </li>
<li>Nicolas Jouvin <br><small class="roles"> Author </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/comeetie/greed/actions"><img src="https://github.com/comeetie/greed/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
<li><a href="https://CRAN.R-project.org/package=greed"><img src="https://www.r-pkg.org/badges/version/greed" alt="CRAN status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Etienne Côme, Nicolas Jouvin.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
